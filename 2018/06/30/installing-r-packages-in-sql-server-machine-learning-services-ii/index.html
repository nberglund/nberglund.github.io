<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Installing R Packages in SQL Server Machine Learning Services - II &middot; Niels Berglund
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Niels Berglund
      </a>
    </div>
    <p class="lead">Technology musings about coding and data. Some topics: .NET, SQL Server, Data Science, R, Windows Azure and a lot more.</p>
  </header>
  <div>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Sidebar_rectangle -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-3005153158271538"
     data-ad-slot="7704601332"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
  </div>
  <br/>
  
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  

  
    
      <a class="page-link "
          href="/about/">About Me</a>
    
  

  
    
      <a class="page-link "
          href="/archive/">Posts Archive</a>
    
  

  
    
      <a class="page-link "
          href="/categories/">Categories</a>
    
  

  
    
  

  
    
      <a class="page-link "
          href="/disclaimer/">Disclaimer</a>
    
  

  
    
  

  
    
  

  

  
    
      <a class="page-link "
          href="/series/">Blog Post Series</a>
    
  

  
    
  

  
    
  

  
    
  

  
    
      <a class="page-link "
          href="/tags/">Tags</a>
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  


  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  
  <br/>
  <img src="/images/MVP_Logo_large.png"/>


  <section>
  <h3 style="color:#ffffff">Follow Me:</h3>
  <ul>
    <li><a href="https://twitter.com/nielsberglund" target="_blank">Twitter</a></li>
    <li><a href="http://feeds.feedburner.com/manageddata/" target="_blank">RSS/Atom Feed</a></li>
  </ul>
</section>
  
  <p>
  &copy; 2018.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">Installing R Packages in SQL Server Machine Learning Services - II</h1>
  <div class="post-subheading">
  <span class="post-date">30 Jun 2018</span>

  <span class="post-tag">
    
      <br/>
      <span class="post-tagdesc">Categories:</span>
    

    
     <a href="/categories/#SQL Server">SQL Server</a>
    
     <a href="/categories/#Microsoft R Server">Microsoft R Server</a>
    
     <a href="/categories/#Microsoft Machine Learning Server">Microsoft Machine Learning Server</a>
    
     <a href="/categories/#Data Science">Data Science</a>
    
     <a href="/categories/#SQL Server R Services">SQL Server R Services</a>
    
     <a href="/categories/#SQL Server Machine Learning Services">SQL Server Machine Learning Services</a>
    

      
  </span>
</div>
  <br/>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3005153158271538"
     data-ad-slot="6668073777"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</header>
<div class="content">
  <div class="post-body">
    <p>This post is the second post in a series about installing R packages in SQL Server Machine Learning Services.</p>

<p>To see all posts in the series go to <a href="/series/sql_server_ml_services_install_packages"><strong>Install R Packages in SQL Server ML Services Series</strong></a>.</p>

<p>Why this series came about is a colleague of mine <a href="https://www.linkedin.com/in/dane-bax/">Dane</a> pinged me and asked if I had any advice as he had issues installing an R package into one of their SQL Server instances. I tried to help him and then thought it would make a good topic for a blog post. Of course, at that time I didn’t think it would be more posts than one, but here we are.</p>

<!--more-->

<h2 id="recap">Recap</h2>

<p>In <a href="/2018/06/23/installing-r-packages-in-sql-server-machine-learning-services-i/">Installing R Packages in SQL Server Machine Learning Services - I</a> we introduced <a href="https://www.linkedin.com/in/dane-bax/">Dane</a> and how he wanted to install some R packages into SQL Server Machine Learning Service instance. I said that before you start installing packages into SQL Server Machine Learning Services, you should make sure you have <strong>Rtools</strong> installed on the machine SQL Server ML Services runs on.</p>

<p>You need <em>RTools</em> if you ever need to compile R packages from source, as <em>Rtools</em> contains compilers and utilities to do this. You do not install <em>Rtools</em> for each SQL Server ML Services instance you have on the server, but just once, and you need to install it from an account with elevated permissions.</p>

<p>In the first post I said that there were three ways to install packages into SQL Server ML Services:</p>

<ul>
  <li>R packet managers</li>
  <li>T-SQL</li>
  <li>RevoScaleR</li>
</ul>

<p>So in the first post, I covered R packet managers, where an R packet manager is an R command line tool or GUI installed on the SQL Server Machine Learning Services machine. The packet manager should be run with elevated permissions and target the R engine for the instance on which you want to install the package. The easiest is to use either of the R tools that come as part as part of SQL Server’s R service:</p>

<ul>
  <li>The command line tool: <code class="highlighter-rouge">Rterm.exe</code>.</li>
  <li>The GUI: <code class="highlighter-rouge">Rgui.exe</code>.</li>
</ul>

<p>These two packet managers lives in the <code class="highlighter-rouge">\\&lt;path_to_SQL_Server_instance&gt;\R_SERVICES\bin\x64</code> directory. When you install packages via an R packet manager, they can only be installed to the default packet library for that instance. The file system folder for this library has restricted access and to write to this folder you need elevated permissions. Typical code for installing packages from a packet manager can look like so:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># get the library path</span><span class="w">
</span><span class="n">libPath</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">.libPaths</span><span class="p">()[</span><span class="m">1</span><span class="p">]</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"pkg_name"</span><span class="p">,</span><span class="w"> </span><span class="n">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">libPath</span><span class="p">,</span><span class="w"> 
                  </span><span class="n">repos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"url_for_the_repo"</span><span class="p">,</span><span class="w"> 
                  </span><span class="n">dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 1:</strong> <em>Install Packages Command</em></p>

<p>In <em>Code Snippet 1</em> we see how I first retrieve the library path. The library path is where I install the package to, and once again - I can only install to the default instance directory. Then in the <code class="highlighter-rouge">install.packages</code> call I use these parameters:</p>

<ul>
  <li>First parameter is always the name of the package(s) to install.</li>
  <li><code class="highlighter-rouge">lib</code>: is for the library folder to install to.</li>
  <li><code class="highlighter-rouge">repos</code>: the base URL(s) of the repositories to use. If left out, the repo used is the Microsoft MRAN repo, which may not be what you want.</li>
  <li><code class="highlighter-rouge">dependencies</code>: indicating whether to also install missing packages which these packages depend on/link to/import/suggest (and so on recursively).</li>
</ul>

<p>The big drawback with using an R packet manager is that the user who does it need to be able to run the chosen packet manager from an elevated prompt and from the box SQL Server is installed on!</p>

<p>In this post, we look at how we can install without being admin, and without having to be logged onto the box as admin.</p>

<h2 id="housekeeping">Housekeeping</h2>

<p>Before we “dive” into today’s topics let us look at the code we use today. This section is here for those of who want to follow along in what we are doing in the post.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">server_principals</span> 
              <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'dane'</span><span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="n">dane</span>
  <span class="k">WITH</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">'password1234$'</span><span class="p">;</span>
<span class="k">END</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">server_principals</span> 
              <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'nielsb'</span><span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="n">nielsb</span>
  <span class="k">WITH</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">'password1234$'</span><span class="p">;</span>
<span class="k">END</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">server_principals</span> 
              <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'user1'</span><span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="n">user1</span>
  <span class="k">WITH</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">'password1234$'</span><span class="p">;</span>
<span class="k">END</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">server_principals</span> 
              <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'user2'</span><span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="n">user2</span>
  <span class="k">WITH</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">'password1234$'</span><span class="p">;</span>
<span class="k">END</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">server_principals</span> 
              <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'user3'</span><span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="n">user3</span>
  <span class="k">WITH</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">'password1234$'</span><span class="p">;</span>
<span class="k">END</span>

<span class="k">DROP</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">DataScienceDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">DataScienceDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="n">USE</span> <span class="n">DataScienceDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">dane</span>
<span class="k">FROM</span> <span class="n">LOGIN</span> <span class="n">dane</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">nielsb</span>
<span class="k">FROM</span> <span class="n">LOGIN</span> <span class="n">nielsb</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">user1</span>
<span class="k">FROM</span> <span class="n">LOGIN</span> <span class="n">user1</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">user2</span>
<span class="k">FROM</span> <span class="n">LOGIN</span> <span class="n">user2</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">user3</span>
<span class="k">FROM</span> <span class="n">LOGIN</span> <span class="n">user3</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">ALTER</span> <span class="k">ROLE</span> <span class="n">db_owner</span>
  <span class="k">ADD</span> <span class="n">MEMBER</span> <span class="n">nielsb</span><span class="p">;</span>
<span class="k">GO</span>
</code></pre></div></div>
<p><strong>Code Snippet 2:</strong> <em>Create Logins, Database and Users</em></p>

<p>In <em>Code Snippet 2</em> we create some logins as well as a database and in that database users for the logins. As you see, we do continue with the “theme” of Dane the data scientist wanting to do “stuff” in the database. As <code class="highlighter-rouge">nielsb</code> is seen to be “trustworthy” (take that Dane), we add him to the <code class="highlighter-rouge">db_owner</code> role.</p>

<h2 id="permissions-and-sp_execute_external_script">Permissions and sp_execute_external_script</h2>

<p>This topic is not directly related to installing R packages via RevoScaleR, but unless you get the permissions right for users that want to call <code class="highlighter-rouge">sp_execute_external_script</code> (SPEES), the rest of the post will not make any sense anyhow. Fortunately I wrote a <a href="/2018/06/24/sp-execute-external-script-and-permissions/">blog post</a> about <em>SPEES</em> and the permissions required, so let us follow what is in that post and set the permissions for the users we created in <em>Code Snippet 2</em>. The code below must be run by <code class="highlighter-rouge">sysadmin</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- the grant to execute SPEES to public only </span>
<span class="c1">-- needs to be run once on the instance</span>
<span class="n">USE</span> <span class="n">master</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">sp_execute_external_script</span> <span class="k">TO</span> <span class="k">public</span><span class="p">;</span>
<span class="k">GO</span>

<span class="n">USE</span> <span class="n">DataScienceDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ANY</span> <span class="k">EXTERNAL</span> <span class="n">SCRIPT</span> <span class="k">TO</span> <span class="n">dane</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ANY</span> <span class="k">EXTERNAL</span> <span class="n">SCRIPT</span> <span class="k">TO</span> <span class="n">user1</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ANY</span> <span class="k">EXTERNAL</span> <span class="n">SCRIPT</span> <span class="k">TO</span> <span class="n">user2</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ANY</span> <span class="k">EXTERNAL</span> <span class="n">SCRIPT</span> <span class="k">TO</span> <span class="n">user3</span><span class="p">;</span>
<span class="k">GO</span>
</code></pre></div></div>
<p><strong>Code Snippet 3:</strong> <em>Grant Execute Permissions to Users</em></p>

<p>We see how the code in <em>Code Snippet 3</em> first, from within the <code class="highlighter-rouge">master</code> database, grants execution rights on <em>SPEES</em> to <code class="highlighter-rouge">public</code>. This only needs to be run once, and arguably this should be part of enabling <em>SPEES</em>.</p>

<p>We then switch over to the database where the users exist, and we grant the <code class="highlighter-rouge">EXECUTE ANY EXTERNAL SCRIPT</code> rights to the individual users that should be able to use <em>SPEES</em>. However, what about <code class="highlighter-rouge">nielsb</code>, should he not be granted the permission as well? No, as he is part of <code class="highlighter-rouge">db_owner</code> he automatically has the necessary permissions.</p>

<h2 id="revoscaler-package-management">RevoScaleR Package Management</h2>

<p>In the recap above I mentioned about being able to install from a remote box and not being an admin on the SQL Server box, and that is what RevoScaleR gives you. RevoScaleR 9.0.1 and later includes functions for R package management where these functions can be used by remote, non-administrators to install packages on SQL Server without direct access to the server. To install you can use both remote R clients as well as <code class="highlighter-rouge">sp_execute_external_script</code> from <em>SSMS</em>. To install using RevoScaleR functions you need to execute inside a <strong>SQL Server Compute Context</strong> (SQLCC).</p>

<blockquote>
  <p><strong>NOTE:</strong> To read more about <em>SQLCC</em> look at the <a href="/2018/05/20/sp-execute-external-script-and-sql-compute-context/">sp_execute_external_script and SQL Compute Context - I</a> post.</p>
</blockquote>

<p>Remember from my <a href="/2018/05/20/sp-execute-external-script-and-sql-compute-context/"><em>SQLCC</em> post</a> how we set up an <em>SQLCC</em>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># set up the connection string</span><span class="w">
</span><span class="n">sqlServerConnString</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Driver=SQL Server;server=&lt;instance&gt;;
                        database=&lt;the_db&gt;;
                        uid=&lt;the user id&gt;;pwd=&lt;the password&gt;"</span><span class="w">

</span><span class="c1"># set up a compute context</span><span class="w">
</span><span class="n">sqlCtx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">RxInSqlServer</span><span class="p">(</span><span class="n">connectionString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlServerConnString</span><span class="p">,</span><span class="w"> 
                        </span><span class="n">numTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="c1"># set the compute context to be the sql context</span><span class="w">
</span><span class="n">rxSetComputeContext</span><span class="p">(</span><span class="n">sqlCtx</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 4:</strong> <em>R Code - SQL Server Compute Context</em></p>

<p>In <em>Code Snippet 4</em> we see how we set up an <em>SQLCC</em> by defining a connection string which then implies that any R package installation is specific to a SQL Server instance as well as a database.</p>

<h4 id="configuration">Configuration</h4>

<p>Above I wrote that even non-admins could install R packages but that requires configuration and to use RevoScaleR you need to enable remote management of R packages both on the SQL Server instance as well as for a particular database. To enable, an admin on the SQL Server box uses a RevoScaleR command line utility: <code class="highlighter-rouge">RegisterRext.exe</code>. The same utility can also be used to disable package management on a database and/or instance level.</p>

<p>The location for <code class="highlighter-rouge">RegisterRext.exe</code> is at: <code class="highlighter-rouge">&lt;path_to_sql_instance&gt;\R_SERVICES\library\RevoScaleR\rxLibs\x64\RegisterRext.exe</code> and when you run it you need to run it as admin. These are the available commands when executing:</p>

<ul>
  <li><code class="highlighter-rouge">/install</code> - copies the launcher binaries to the right location for a SQL server instance. Not applicable in this post.</li>
  <li><code class="highlighter-rouge">/uninstall</code> - removes the launcher binaries from the SQL server instance. Not applicable in this post.</li>
  <li><code class="highlighter-rouge">/installpkgmgmt</code> - installs package management support for given SQL server instance and database also if specified.</li>
  <li><code class="highlighter-rouge">/uninstallpkgmgmt</code> - uninstalls package management support from given SQL server instance and database also if specified.</li>
  <li><code class="highlighter-rouge">/installrts</code> - installs real time scoring support for given SQL server instance and database. Topic for a future post.</li>
  <li><code class="highlighter-rouge">/uninstallrts</code> - uninstalls real time scoring support for given SQL server instance and database. Topic for a future post.</li>
</ul>

<p>We send in parameters to tell RegisterRext where to execute:</p>

<ul>
  <li><code class="highlighter-rouge">/instance:value</code> is an optional parameter, we use <code class="highlighter-rouge">&lt;value&gt;</code> as the instance name, else the commands are performed on the default instance. Please note that the name is just that; not <code class="highlighter-rouge">/instance:server_name\instance_name</code> but <code class="highlighter-rouge">/instance:instance_name</code>. It took me a while to figure that out.</li>
  <li><code class="highlighter-rouge">/database:value</code> is an optional parameter where <code class="highlighter-rouge">&lt;value&gt;</code> indicates what database to run on.</li>
  <li><code class="highlighter-rouge">/user:username</code> is an optional parameter, and we use the <code class="highlighter-rouge">&lt;username</code>&gt; specified to connect via the SQL authentication mode. Note that once this parameter is specified, <code class="highlighter-rouge">/password:&lt;value&gt;</code> is a required parameter.</li>
  <li><code class="highlighter-rouge">/password: * | &lt;password&gt;</code> is a required parameter once the <code class="highlighter-rouge">/user</code> parameter is provided. You can use <code class="highlighter-rouge">/password:*</code> in order to be prompted for the password when running the tool instead of providing it in cleartext as a parameter. Note that providing the password without the user is ignored.</li>
</ul>

<p>If no username and password is supplied, then Windows authentication is used (in the context of the user which is logged on to the SQL Server box and runs <code class="highlighter-rouge">RegisterRext.exe</code>).</p>

<p>Let us go back to <a href="https://www.linkedin.com/in/dane-bax/">Dane</a> and his situation and see what we can do. Admin of the SQL Server instance Dane <del>plays on</del> works hard on has created a database for Dane with a lot of data where Dane now want to do data science “things”. Part of the things Dane want to do requires packages that are not part of a SQL Server ML Services installation.</p>

<p>So the admin decides to enable Dane’s database for remote package management. As this is the first time a database on the instance is enabled, the admin needs to enable the instance itself before the database.</p>

<p>To enable the instance a user with admin rights on the box, logs on and runs <code class="highlighter-rouge">RegisterRext.exe</code> from an elevated command prompt:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> RegisterRext.exe /installpkgmgmt
</code></pre></div></div>
<p><strong>Code Snippet 5:</strong> <em>Enable Default Instance</em></p>

<p>In <em>Code Snippet 5</em> we enable packet management on the default instance (as that is where Dane’s database is), and we enable it using Windows Authentication. Regardless of type of authentication, the user has to have <code class="highlighter-rouge">VIEW SERVER STATE</code> permissions on the SQL Server instance. The output from <em>Code Snippet 5</em> is like so (edited for readability):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span>RegisterRExt /installpkgmgmt

Source directory to pick the RExtension binaries determined 
to be <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\M</span><span class="s2">SSQL14.MSSQLSERVER</span><span class="se">\</span><span class="s2">
R_SERVICES</span><span class="se">\l</span><span class="s2">ibrary</span><span class="se">\R</span><span class="s2">evoScaleR</span><span class="se">\r</span><span class="s2">xLibs</span><span class="se">\x</span><span class="s2">64</span><span class="se">\"</span><span class="s2">.

Connecting to SQL server...

Sql server binn directory is 
"</span>C:<span class="se">\P</span>rogram Files<span class="se">\M</span>icrosoft SQL Server<span class="se">\M</span>SSQL14.MSSQLSERVER<span class="se">\M</span>SSQL<span class="se">\B</span>inn<span class="s2">".

Stopping service MSSQLLaunchpad...
Copied RLauncher.dll from C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\R</span><span class="s2">_SERVICES</span><span class="se">\l</span><span class="s2">ibrary</span><span class="se">\R</span><span class="s2">evoScaleR</span><span class="se">\r</span><span class="s2">xLibs</span><span class="se">\x</span><span class="s2">64</span><span class="se">\ </span><span class="s2">
to C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\M</span><span class="s2">SSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\B</span><span class="s2">inn.

Installing SQL R services package management for instance ''

Installing version 1.0 artifacts

Creating package management account MSSQLSERVERPKG...

Saving package management user account configuration...

Working directory long path:'C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">xtensibilityData' and short path:
'C:</span><span class="se">\P</span><span class="s2">ROGRA~1</span><span class="se">\M</span><span class="s2">ICROS~1</span><span class="se">\M</span><span class="s2">SSQL1~1.MSS</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">XTENS~1'.

Working directory long path:'C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">xtensibilityData' and short path:
'C:</span><span class="se">\P</span><span class="s2">ROGRA~1</span><span class="se">\M</span><span class="s2">ICROS~1</span><span class="se">\M</span><span class="s2">SSQL1~1.MSS</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">XTENS~1'.

Working directory long path:'C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">xtensibilityData' and short path:
'C:</span><span class="se">\P</span><span class="s2">ROGRA~1</span><span class="se">\M</span><span class="s2">ICROS~1</span><span class="se">\M</span><span class="s2">SSQL1~1.MSS</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">XTENS~1'.

Configuring security for folder C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">xtensibilityData...

SQL R services package management installed successfully.

Starting service MSSQLLaunchpad...
</span></code></pre></div></div>
<p><strong>Code Snippet 6:</strong> <em>Output Enable Instance</em></p>

<p>A couple of interesting points from what we see in <em>Code Snippet 6</em>:</p>

<ul>
  <li>The launchpad service is stopped when the install process starts and at the end restarted.</li>
  <li>The install process creates a new packet management account. This account appears together with the worker accounts in the <em>user accounts</em> pool that you find in the <code class="highlighter-rouge">ExtensibilityData</code> folder.</li>
</ul>

<blockquote>
  <p><strong>NOTE:</strong> As the instance only is enabled once, this could potentially be part of when we enable an instance for external scripts.</p>
</blockquote>

<p>Having enabled the instance, admin can now go ahead and enable the database:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> RegisterRext.exe /installpkgmgmt /database:DataScienceDB
</code></pre></div></div>
<p><strong>Code Snippet 7:</strong> <em>Enable Database</em></p>

<p>In <em>Code Snippet 7</em> we see how we enable packet management on the <code class="highlighter-rouge">DataScienceDB</code> database, once again using Windows Authentication. Whereas enabling an instance requires <code class="highlighter-rouge">VIEW SERVER STATE</code> permissions for the authenticated user, when enabling a database the user needs both <code class="highlighter-rouge">VIEW SERVER STATE</code> as well as being part of the <code class="highlighter-rouge">db_owner</code> database role.</p>

<p>The output from <em>Code Snippet 7</em> is like so:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span>RegisterRExt /installpkgmgmt /database:DataScienceDB

Source directory to pick the RExtension binaries determined 
to be <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\M</span><span class="s2">SSQL14.MSSQLSERVER</span><span class="se">\</span><span class="s2">
R_SERVICES</span><span class="se">\l</span><span class="s2">ibrary</span><span class="se">\R</span><span class="s2">evoScaleR</span><span class="se">\r</span><span class="s2">xLibs</span><span class="se">\x</span><span class="s2">64</span><span class="se">\"</span><span class="s2">.

Connecting to SQL server...

Sql server binn directory is "</span>C:<span class="se">\P</span>rogram Files<span class="se">\M</span>icrosoft SQL Server<span class="se">\M</span>SSQL14.MSSQLSERVER<span class="se">\M</span>SSQL<span class="se">\B</span>inn<span class="s2">".

Installing SQL R services package management for database 'DataScienceDB'

Installing version 1.0 artifacts

Working directory long path:'C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">xtensibilityData' and short path:
'C:</span><span class="se">\P</span><span class="s2">ROGRA~1</span><span class="se">\M</span><span class="s2">ICROS~1</span><span class="se">\M</span><span class="s2">SSQL1~1.MSS</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">XTENS~1'.

Creating package management folder C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\M</span><span class="s2">icrosoft SQL Server</span><span class="se">\</span><span class="s2">
MSSQL14.MSSQLSERVER</span><span class="se">\M</span><span class="s2">SSQL</span><span class="se">\E</span><span class="s2">xtensibilityData</span><span class="se">\</span><span class="s2">
rpkgs</span><span class="se">\4</span><span class="s2">ecd5724-d180-47da-a8e0-01d6c1b9bd0f...

Creating package management table rpackages...

Creating package management role rpkgs-users...

Creating package management role rpkgs-private...

Creating package management role rpkgs-shared...

Creating package management stored procedures ...

Installing version 1.1 artifacts

Altering package management table rpackages to include attributes flags...

Creating package management stored procedures ...

SQL R services package management installed successfully for database 'DataScienceDB'
</span></code></pre></div></div>
<p><strong>Code Snippet 8:</strong> <em>Output Enable Database</em></p>

<p>As with the output from enabling an instance (<em>Code Snippet 6</em>) we see some interesting things in <em>Code Snippet 8</em> for when enabling a database, and we see how the process:</p>

<ul>
  <li>Creates a table: <code class="highlighter-rouge">rpackages</code>.</li>
  <li>Creates roles.</li>
  <li>Creates stored procedures:</li>
</ul>

<p><img src="/images/posts/sql_ml_install_r_pckgs_procedures.png" alt="" /></p>

<p><strong>Figure 1:</strong> <em>Stored Procedures Created</em></p>

<p>In <em>Figure 1</em> we see the procedures that the enabling process created. In a future post, we talk more about these procedures</p>

<h2 id="revoscaler-functions-scopes--roles">RevoScaleR Functions, Scopes &amp; Roles</h2>

<p>RevoScaleR exposes functions similar to CRAN R functions for package management:</p>

<ul>
  <li><code class="highlighter-rouge">rxSqlLibPaths</code>: Retrieves the path of the instance library on the remote server.</li>
  <li><code class="highlighter-rouge">rxFindPackage</code>: retrieves the path for one or more packages on the remote SQL Server.</li>
  <li><code class="highlighter-rouge">rxInstallPackages</code>: Install packages and their dependencies in an SQLCC from a remote client. You can specify which repo to install from or also install from locally saved zipped packages.</li>
  <li><code class="highlighter-rouge">rxInstalledPackages</code>:  Retrieves a list of packages installed in the specified compute context.</li>
  <li><code class="highlighter-rouge">rxSyncPackages</code>:  Copy information about a package library between the file system and database.</li>
  <li><code class="highlighter-rouge">rxRemovePackages</code>:  Removes packages from a specified compute context. It also removes dependencies if other packages on SQL Server no longer use them.</li>
</ul>

<p>Back to our “hero” Dane. Admin has just told him that the SQL Server instance together with his database are now package management enabled, so he can begin to do his awesome “stuff”. So what Dane first want to do is to see what packages are available to him in his database, and he does not really want to use <em>SSMS</em>, but instead use his R client of choice; Visual Studio together with <strong>Microsoft R Client</strong>:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs_VS1.png" alt="" /></p>

<p><strong>Figure 2:</strong> <em>Visual Studio with Microsoft R Client</em></p>

<p>In <em>Figure 2</em> we see how Dane’s R project in Visual Studio targets  Microsoft R Client. Dane now wants to use the following code to see packages available on his database:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">sqlCCConnString</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Driver=SQL Server; server=&lt;server_name&gt;; 
                     database=daneb; uid=daneb; pwd=&lt;danes_pwd&gt;"</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sqlCC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">RxInSqlServer</span><span class="p">(</span><span class="n">connectionString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlCCConnString</span><span class="p">,</span><span class="w"> </span><span class="n">numTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rxSetComputeContext</span><span class="p">(</span><span class="n">sqlCC</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sqlPackages</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rxInstalledPackages</span><span class="p">(</span><span class="n">computeContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlCC</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sqlPackages</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 9:</strong></p>

<p>In <em>Code Snippet 9</em> we see how Dane:</p>

<ul>
  <li>Sets up a connection string pointing to his database for the SQLCC.</li>
  <li>Creates the SQLCC and sets it.</li>
  <li>Calls <code class="highlighter-rouge">rxInstalledPackages</code> to retrieve packages.</li>
</ul>

<p>When Dane executes the code in <em>Code Snippet 9</em> it does not go as he wants - he gets an error at the <code class="highlighter-rouge">rxInstalledPackages</code> call:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Error</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">rxCheckPackageManagementVersion</span><span class="w">
     </span><span class="p">(</span><span class="n">connectionString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">computeContext</span><span class="o">@</span><span class="n">connectionString</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> 
  </span><span class="n">The</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> 
  </span><span class="n">user</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="m">14.0.1000.169</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 10:</strong> <em>Execution Error</em></p>

<p>Hmm, the error we see in <em>Code Snippet 10</em> says something about “The package management feature is not enabled…”  What is this all about?</p>

<h4 id="scopes--roles">Scopes &amp; Roles</h4>

<p>The error above is related to what happened when we enabled the database. Remember how the process created roles in the database and the user that tries to execute some of the package management functions need to be in some of the roles unless the user is part of <code class="highlighter-rouge">db_owner</code>. In <em>Code Snippet 8</em> we see the roles, and there is a role named <code class="highlighter-rouge">rpkgs-users</code>. When I see that role, it seems like a good candidate for Dane to be part of, so I add Dane to the role:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">ROLE</span> <span class="p">[</span><span class="n">rpkgs</span><span class="o">-</span><span class="n">users</span><span class="p">]</span> 
  <span class="k">ADD</span> <span class="n">MEMBER</span> <span class="n">dane</span><span class="p">;</span>
</code></pre></div></div>
<p><strong>Code Snippet 11:</strong> <em>Add Member to Role</em></p>

<p>Notice in <em>Code Snippet 11</em> how I have to enclose the role name in brackets([]) as the name has a hyphen in it. When Dane now tries to execute the code:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs_scope_error.png" alt="" /></p>

<p><strong>Figure 3:</strong> <em>Error</em></p>

<p>Ok, we seem to be a little bit further than before, and it seems we now can execute, but there is still an error, and it looks related to “scope”, whatever that is.</p>

<p>Scopes has to do with installation of packages via the <em>SQLCC</em> and the usage of those packages. There are two scopes:</p>

<ul>
  <li>Shared: shares packages with other users in the database.</li>
  <li>Private: accessible only to the user installing the package.</li>
</ul>

<p>Scope and the roles we see above are related in that the roles define what the user can do and in what scope:</p>

<ul>
  <li><code class="highlighter-rouge">rpkgs-users</code>: users in this role can use packages installed by users belonging to the <code class="highlighter-rouge">rpkgs-shared</code> role. Cannot read via the <code class="highlighter-rouge">rx...</code> functions.</li>
  <li><code class="highlighter-rouge">rpkgs-private</code>: this role has all permissions as the <code class="highlighter-rouge">rpkgs-users</code> role has. A user in this role can furthermore, install, remove and use private packages installed by the user in question.</li>
  <li><code class="highlighter-rouge">rpkgs-shared</code>: The same permissions as the <code class="highlighter-rouge">rpkgs-private</code> role. Users in this role can install, remove, and use shared packages.</li>
</ul>

<p>So, let us now see what we can do with these roles:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">ROLE</span> <span class="p">[</span><span class="n">rpkgs</span><span class="o">-</span><span class="n">users</span><span class="p">]</span> 
  <span class="k">ADD</span> <span class="n">MEMBER</span> <span class="n">user1</span><span class="p">;</span>

<span class="k">ALTER</span> <span class="k">ROLE</span> <span class="p">[</span><span class="n">rpkgs</span><span class="o">-</span><span class="n">shared</span><span class="p">]</span> 
  <span class="k">ADD</span> <span class="n">MEMBER</span> <span class="n">dane</span><span class="p">;</span>

<span class="k">ALTER</span> <span class="k">ROLE</span> <span class="p">[</span><span class="n">rpkgs</span><span class="o">-</span><span class="n">shared</span><span class="p">]</span> 
  <span class="k">ADD</span> <span class="n">MEMBER</span> <span class="n">user2</span><span class="p">;</span>

<span class="k">ALTER</span> <span class="k">ROLE</span> <span class="p">[</span><span class="n">rpkgs</span><span class="o">-</span><span class="n">private</span><span class="p">]</span> 
  <span class="k">ADD</span> <span class="n">MEMBER</span> <span class="n">user3</span><span class="p">;</span>

</code></pre></div></div>
<p><strong>Code Snippet 12:</strong> <em>Add Users to Roles</em></p>

<p>After we have added users to various roles, let us see what happens when different users want to install packages.</p>

<h2 id="revoscaler-package-installation">RevoScaleR Package Installation</h2>

<p>In the following examples, I have chosen a package <code class="highlighter-rouge">abc</code> mostly due to it not having too many dependencies, which makes it quicker to install. The <code class="highlighter-rouge">abc</code> package contains tools for “Approximate Bayesian Computation” (ABC).</p>

<p>Something to think about are the versions of <em>RevoScaleR</em> on your development box vs the version on the remote SQL Server. My, admittedly, limited investigations lead me to believe that the version on the local machine cannot be an earlier version than on the remote SQL Server. If the version is earlier on the local machine, you get permission errors. From what I can tell, the local version can be the same, or newer.</p>

<p>Ok, so to install packages we use <code class="highlighter-rouge">rxInstallPackagaes()</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rxInstallPackages</span><span class="p">(</span><span class="n">pkgs</span><span class="p">,</span><span class="w"> </span><span class="n">skipMissing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> 
                  </span><span class="n">repos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getOption</span><span class="p">(</span><span class="s2">"repos"</span><span class="p">),</span><span class="w"> 
                  </span><span class="n">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getOption</span><span class="p">(</span><span class="s2">"verbose"</span><span class="p">),</span><span class="w"> 
                  </span><span class="n">scope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"private"</span><span class="p">,</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="p">,</span><span class="w"> 
                  </span><span class="n">computeContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rxGetOption</span><span class="p">(</span><span class="s2">"computeContext"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 13:</strong> <em>Signature rxInstallPackages</em></p>

<p>Let us look at the parameters we see in <em>Code Snippet 13</em>:</p>

<p><strong><code class="highlighter-rouge">pkgs</code>:</strong></p>

<p>String array of the packages you want to download and install. By default, it downloads the latest version of the package(s). When installing through an <strong>SQLCC</strong> the arrays can be .zip files as well as URL’s, <code class="highlighter-rouge">http://</code> and <code class="highlighter-rouge">file://</code>. If the URL is a file, the location must be available to SQL Server.</p>

<p><strong><code class="highlighter-rouge">skipMissing</code>:</strong></p>

<p>Boolean (<code class="highlighter-rouge">TRUE</code>, <code class="highlighter-rouge">FALSE</code>) indicating whether not to download dependent packages. The argument defaults to false.</p>

<p><strong><code class="highlighter-rouge">repos</code>:</strong></p>

<p>String array of base URL’s of repos to use. It defaults to the MRAN repo. If you want to install from local files <code class="highlighter-rouge">repos</code> has to be explicitly set to <code class="highlighter-rouge">NULL</code>.</p>

<p><strong><code class="highlighter-rouge">verbose</code>:</strong></p>

<p>Boolean (<code class="highlighter-rouge">TRUE</code>, <code class="highlighter-rouge">FALSE</code>) indicating whether to output progress during installation.</p>

<p><strong><code class="highlighter-rouge">scope</code>:</strong></p>

<p>Related to what I said above about <code class="highlighter-rouge">scope</code>. The <code class="highlighter-rouge">scope</code> argument indicates whether to install packages, so they are available for other users on the database: <code class="highlighter-rouge">shared</code>, or only accessible to the user calling <code class="highlighter-rouge">rxInstallPackages</code>: <code class="highlighter-rouge">private</code>. The default value is <code class="highlighter-rouge">private</code>. To install to <code class="highlighter-rouge">shared</code> scope the user has to be in the <code class="highlighter-rouge">rpkgs-shared</code> or <code class="highlighter-rouge">db_owner</code> role.</p>

<p><strong><code class="highlighter-rouge">owner</code>:</strong></p>

<p>A user in the <code class="highlighter-rouge">db_owner</code> role can install packages on behalf of other users, and set the <code class="highlighter-rouge">owner</code> parameter to a valid database user account.</p>

<p><strong><code class="highlighter-rouge">computeContext</code>:</strong></p>

<p>The compute context to install under.</p>

<h4 id="install-already">Install Already</h4>

<p>Finally, we can talk about actually installing a package. Dane now wants to install the <code class="highlighter-rouge">abc</code> package:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sqlCCConnString</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Driver=SQL Server; 
                    server=192.168.57.3;
                    database=DataScienceDB; 
                    uid=dane; pwd=password1234$"</span><span class="w">
</span><span class="n">sqlCC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">RxInSqlServer</span><span class="p">(</span><span class="n">connectionString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlCCConnString</span><span class="p">,</span><span class="w"> </span><span class="n">numTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">rxSetComputeContext</span><span class="p">(</span><span class="n">sqlCC</span><span class="p">)</span><span class="w">
</span><span class="n">pkgs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">)</span><span class="w">
</span><span class="n">rxInstallPackages</span><span class="p">(</span><span class="n">pkgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkgs</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">computeContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlCC</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 14:</strong> <em>Install R Package</em></p>

<p>In <em>Code Snippet 14</em> we see how Dane:</p>

<ul>
  <li>Sets up the connection string for the <em>SQLCC</em>.</li>
  <li>Created the <em>SQLCC</em> and sets it.</li>
  <li>Defines the package(s): <code class="highlighter-rouge">pkgs &lt;- c("abc")</code>.</li>
</ul>

<p>When he calls <code class="highlighter-rouge">rxInstallPackages</code>, he follows the progress in the Visual Studio R interactive window:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs2_install_progress.png" alt="" /></p>

<p><strong>Figure 4:</strong> <em>Installation Progress</em></p>

<p>Dane sees in <em>Figure 4</em> how the various packages needed for <code class="highlighter-rouge">abc</code> downloads and subsequently installed. After a couple of minutes the installation is completed:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs2_install_fiished.png" alt="" /></p>

<p><strong>Figure 5:</strong> <em>Installation Finished</em></p>

<p>After the installation has finished, let us see how it works.</p>

<h4 id="usage">Usage</h4>

<p>So in <em>Figure 5</em> we see that the installation finished successfully. Dane wants now to start using the new packages he installed in SQL Server, and for testing purposes, he uses the <code class="highlighter-rouge">abc.data</code> package (installed as a dependency of the <code class="highlighter-rouge">abc</code> package):</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">EXEC</span> <span class="n">sp_execute_external_script</span> 
         <span class="o">@</span><span class="k">language</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'R'</span><span class="p">,</span>
         <span class="o">@</span><span class="n">script</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'
                library("abc.data")
                data(human)
                OutputDataSet &lt;-  data.frame(stat.voight)'</span>
<span class="k">WITH</span> <span class="k">RESULT</span> <span class="k">SETS</span><span class="p">(([</span><span class="n">pi</span><span class="p">]</span> <span class="n">float</span><span class="p">,</span> <span class="p">[</span><span class="n">TajD</span><span class="p">.</span><span class="n">m</span><span class="p">]</span> <span class="n">float</span><span class="p">,</span> <span class="p">[</span><span class="n">TajD</span><span class="p">.</span><span class="n">v</span><span class="p">]</span> <span class="n">float</span> <span class="p">))</span>
</code></pre></div></div>
<p><strong>Code Snippet 15:</strong> <em>Using R Package</em></p>

<p>In <em>Code Snippet 15</em> it is assumed that Dane has logged in as himself and we see how Dane uses <a href="https://www.rdocumentation.org/packages/abc.data/versions/1.0/topics/human"><code class="highlighter-rouge">human</code></a> which is a set of R objects containing observed data from three human populations. The call <code class="highlighter-rouge">data(human)</code>, loads in four R objects and Dane is interested in <code class="highlighter-rouge">stat.voight</code>, which is a data frame with 3 rows and 3 columns. The data frame contains the observed summary statistics for three human populations. In his code, Dane outputs the <code class="highlighter-rouge">stat.voight</code> data frame. However, when Dane executes the code, this happens:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs2_error_exec1.png" alt="" /></p>

<p><strong>Figure 6:</strong> <em>Package does not Exist</em></p>

<p>Hmm, what happened here? We know that Dane installed the package, so why does he get an exception that the package does not exist? The reason is that the package he installed is not installed in the R engine, but installed on the database and is not visible. To be able to use the package Dane needs to execute under the <em>SQLCC</em>.</p>

<blockquote>
  <p><strong>NOTE:</strong> In future posts we talk more about where the packages are installed and how they get loaded etc.</p>
</blockquote>

<p>So, how does Dane make the <code class="highlighter-rouge">abc.data</code> package execute in the <em>SQLCC</em>. Well, the <code class="highlighter-rouge">abc.data</code> package does not know about <em>SQLCC</em>, so Dane needs to use a RevoScaleR wrapper function: <code class="highlighter-rouge">rxExec</code>. The <code class="highlighter-rouge">rxExec</code> function allows distributed execution of a function, and the signature looks like so:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rxExec</span><span class="p">(</span><span class="n">FUN</span><span class="p">,</span><span class="w">   </span><span class="n">...</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">elemArgs</span><span class="p">,</span><span class="w"> </span><span class="n">elemType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"nodes"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">oncePerElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">timesToRun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1L</span><span class="p">,</span><span class="w">
       </span><span class="n">packagesToLoad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">execObjects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> 
       </span><span class="n">taskChunkSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">quote</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> 
       </span><span class="n">consoleOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">autoCleanup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> 
       </span><span class="n">continueOnFailure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">RNGseed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> 
       </span><span class="n">RNGkind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">foreachOpts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">

</span></code></pre></div></div>
<p><strong>Code Snippet 16:</strong> <em>Signature of rxExec</em></p>

<p>In <em>Code Snippet 16</em> we see <code class="highlighter-rouge">rxExec</code>’s signature. In a future post we look at <code class="highlighter-rouge">rxExec</code> in more detail, but for now what interests us are the two first parameters:</p>

<ul>
  <li><code class="highlighter-rouge">FUN</code>: The function to execute.</li>
  <li><code class="highlighter-rouge">...</code>: Arguments passed to the function (<code class="highlighter-rouge">FUN</code>).</li>
</ul>

<p>The first parameter is the function we want <code class="highlighter-rouge">rxExec</code> to execute and the second parameter passes in the argument(s) the function requires. So, if we go back to what Dane wants to do, he re-writes his code like so:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">EXEC</span> <span class="n">sp_execute_external_script</span> 
 <span class="o">@</span><span class="k">language</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'R'</span><span class="p">,</span>
 <span class="o">@</span><span class="n">script</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'
   # define a function to be passed to rxExec
   usePackageInRxFunction &lt;- function()
   {
     library("abc.data")
     data(human)
     return(stat.voight)
   }
   # the "normal" SQLCC stuff
   sqlCCConnString &lt;- "Driver=SQL Server; server=.; 
                       database=DataScienceDB; 
                       uid=dane; pwd=password1234$"
   sqlCC &lt;- RxInSqlServer(connectionString = sqlCCConnString, 
                          numTasks = 1)
   rxSetComputeContext(sqlCC)

   ret &lt;- rxExec(usePackageInRxFunction)
   OutputDataSet &lt;- data.frame(ret)'</span>
<span class="k">WITH</span> <span class="k">RESULT</span> <span class="k">SETS</span><span class="p">(([</span><span class="n">pi</span><span class="p">]</span> <span class="n">float</span><span class="p">,</span> <span class="p">[</span><span class="n">TajD</span><span class="p">.</span><span class="n">m</span><span class="p">]</span> <span class="n">float</span><span class="p">,</span> <span class="p">[</span><span class="n">TajD</span><span class="p">.</span><span class="n">v</span><span class="p">]</span> <span class="n">float</span> <span class="p">))</span>
</code></pre></div></div>
<p><strong>Code Snippet 17:</strong> <em>Executing in SQLCC</em></p>

<p>We see how Dane in <em>Code Snippet 17</em>:</p>

<ul>
  <li>Creates a function <code class="highlighter-rouge">usePackageInRxFunction</code> where he does the <code class="highlighter-rouge">abc.data</code> related work.</li>
  <li>Creates and sets up the <em>SQLCC</em>.</li>
  <li>Calls <code class="highlighter-rouge">rxExec</code> with <code class="highlighter-rouge">usePackageInRxFunction</code> as argument.</li>
  <li>Returns a data set.</li>
</ul>

<p>When Dane executes the code the result is:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs2_exec_success1.png" alt="" /></p>

<p><strong>Figure 7:</strong> <em>Success</em></p>

<p>So, everything works fine, and Dane gets a result back. What happens if someone else wants to execute the same code, for example, <code class="highlighter-rouge">nielsb</code> who is in the <code class="highlighter-rouge">db_owner</code> role? The only thing <code class="highlighter-rouge">nielsb</code> changes is the <code class="highlighter-rouge">sqlCCConnString</code> parameter:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sqlCCConnString</span> <span class="o">&lt;-</span> <span class="nv">"Driver=SQL Server; server=.; 
                       database=DataScienceDB; 
                       uid=nielsb; pwd=password1234$"</span>
</code></pre></div></div>
<p><strong>Code Snippet 18:</strong> <em>SQLCC Connectionstring for nielsb</em></p>

<p>When <code class="highlighter-rouge">nielsb</code> executes the code in <em>Code Snippet 17</em> but with the <code class="highlighter-rouge">sqlCCConnString</code> parameter looking like in <em>Code Snippet 18</em> the outcome is:</p>

<p><img src="/images/posts/sql_ml_install_r_pckgs2_error_exec2.png" alt="" /></p>

<p><strong>Figure 7:</strong> <em>No Package Exception</em></p>

<p>Hmm, that is strange - we know Dane installed the package (and he just used it), so it has to exist. Dane is part of the <code class="highlighter-rouge">rpkgs-shared</code> role so he has permissions to create shared packages? The reason here is even though Dane was in <code class="highlighter-rouge">rpkgs-shared</code> role when he ran <code class="highlighter-rouge">rxInstallPackages</code> (<em>Code Snippet 14</em>) he did not define the scope for the package. Remember when we looked at the signature and the arguments for <code class="highlighter-rouge">rxInstallPackages</code> in <em>Code Snippet 13</em> we said that default value for the <code class="highlighter-rouge">scope</code> argument is <code class="highlighter-rouge">private</code> and that is how the package is installed regardless of what role Dane is in.</p>

<p>So to finish off, let <code class="highlighter-rouge">user2</code> who is in <code class="highlighter-rouge">rpkgs-shared</code> install the same packages in <code class="highlighter-rouge">shared</code> scope. Does that work, can you have the same packages installed multiple times? Yes, you can in that you can have the same packages installed in both <code class="highlighter-rouge">private</code> as well as <code class="highlighter-rouge">shared</code> scope. So <code class="highlighter-rouge">user2</code> executes this code:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sqlCCConnString</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Driver=SQL Server; 
                    server=192.168.57.3;
                    database=DataScienceDB; 
                    uid=user2; pwd=password1234$"</span><span class="w">
</span><span class="n">sqlCC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">RxInSqlServer</span><span class="p">(</span><span class="n">connectionString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlCCConnString</span><span class="p">,</span><span class="w"> </span><span class="n">numTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">rxSetComputeContext</span><span class="p">(</span><span class="n">sqlCC</span><span class="p">)</span><span class="w">
</span><span class="n">pkgs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">)</span><span class="w">
</span><span class="n">rxInstallPackages</span><span class="p">(</span><span class="n">pkgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkgs</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"shared"</span><span class="p">,</span><span class="w"> </span><span class="n">computeContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlCC</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p><strong>Code Snippet 19:</strong> <em>Install R Package</em></p>

<p>The only changes here in <em>Code Snippet 19</em> compared to the code in <em>Code Snippet 14</em> are the user id (<code class="highlighter-rouge">uid</code> -obviously), and <code class="highlighter-rouge">scope = "shared"</code> in the <code class="highlighter-rouge">rxInstallPackages</code> call. The <code class="highlighter-rouge">abc</code> package is now installed in <code class="highlighter-rouge">shared</code> scope, and anyone in any of the <code class="highlighter-rouge">rpkgs-...</code> roles can use the package.</p>

<h2 id="summary">Summary</h2>

<p>This turned out to be a much longer post than I thought it would be, and there are still topics related to RevoScaleR installation functionality that I want to cover, but that comes in future posts.</p>

<p>So, here is what we covered:</p>

<ul>
  <li>To use RevoScaleR for package installation both the SQL Server instance as well as the database need to be enabled for package management. You enable package management via <code class="highlighter-rouge">RegisterRExt.exe</code> tool and the <code class="highlighter-rouge">/installpkgmgmt</code> option. There are additional flags for database enabling, authentication and so forth.</li>
  <li>When enabling the database the process creates a table, stored procedures and roles.</li>
  <li>For a user to be able to install packages he needs to have necessary permissions on <code class="highlighter-rouge">sp_execute_external_script1 as well as the </code>EXECUTE ANY EXTERNAL SCRIPT` permission. He also needs to be in a role which allows him to install packages.</li>
  <li>The roles that the enabling process creates are: <code class="highlighter-rouge">rpkgs-users</code>, <code class="highlighter-rouge">rpkgs-private</code> and <code class="highlighter-rouge">rpkgs-shared</code>.</li>
  <li>The roles which allows the user to install packages are <code class="highlighter-rouge">rpkgs-private</code> and <code class="highlighter-rouge">rpkgs-shared</code> (and <code class="highlighter-rouge">db_owner</code>).</li>
  <li>The roles define the scope of the installed packages: <code class="highlighter-rouge">private</code> and <code class="highlighter-rouge">shared</code>.</li>
  <li>When a user installs a package with <code class="highlighter-rouge">private</code> scope, only he can see and use the package.</li>
  <li>If the user installs a package with <code class="highlighter-rouge">shared</code> scope, all users in any of the roles, including <code class="highlighter-rouge">rpkgs-users</code> can use that package. The user needs to be in the <code class="highlighter-rouge">rpkgs-shared</code> (or <code class="highlighter-rouge">db_owner</code>) to install a <code class="highlighter-rouge">shared</code> package.</li>
  <li>You use the function <code class="highlighter-rouge">rxInstallPackages</code> to install a package, and the function needs to run in an <em>SQLCC</em>.</li>
  <li>When the user calls <code class="highlighter-rouge">rxInstallPackages</code> he needs to define which scope the package has through the <code class="highlighter-rouge">scope</code> argument. If the <code class="highlighter-rouge">scope</code> is not defined, it defaults to <code class="highlighter-rouge">private</code>.</li>
  <li>To use a package, either in <code class="highlighter-rouge">private</code> or <code class="highlighter-rouge">shared</code> scope, the code needs to run in <em>SQLCC</em>.</li>
  <li>For a package that has no knowledge about <em>SQLCC</em>, the functions in the package can be run via <code class="highlighter-rouge">rxExec</code>.</li>
</ul>

<h2 id="-finally">~ Finally</h2>

<p>If you have comments, questions etc., please comment on this post or <a href="mailto:niels.it.berglund@gmail.com">ping</a> me.</p>



    
<p>
<h2>Share this Post:</h2> 
<a href="https://twitter.com/intent/tweet?url=http://nielsberglund.com/2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/&text=Installing R Packages in SQL Server Machine Learning Services - II&via=nielsberglund" 
   target="_blank">Twitter</a>
<a href="https://plus.google.com/share?url=http://www.nielsberglund.com//2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/" 
   onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
    | Google+</a>
<a href="https://www.linkedin.com/shareArticle?
         mini=true
         &url=http://www.nielsberglund.com/2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/
         &title=Installing R Packages in SQL Server Machine Learning Services - II
         &summary=Blog post: We continue looking at installing R packages. This post is all about using RevoScaleR functionality.
         &source=http://www.nielsberglund.com/2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/"> | LinkedIn</a> 

</p>   
   <!--<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

   http://www.linkedin.com/shareArticle?mini=true&url=<URL>&title=<TITILE>&summary=<DESCRIPTION>&sourc


   https://www.linkedin.com/shareArticle?mini=true&url=http://nielsberglund.com/2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/

   -->



    <p>
<h2>Blog Feed:</h2>
To automatically receive more posts like this, please
<a href="http://feeds.feedburner.com/manageddata/" target="_blank"> subscribe to my RSS/Atom feed</a> in your feed reader!</p>


    <br/>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad2 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3005153158271538"
     data-ad-slot="1158080725"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    <br/>

    


  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
    <h2>Post Tags:</h2>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  


<div class="post-tags">
  
    
    <a href="/tags/#sql-server-r-services">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">SQL Server R Services</span>
    </a>
  
    
    <a href="/tags/#sql-server-machine-learning-services">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">SQL Server Machine Learning Services</span>
    </a>
  
    
    <a href="/tags/#r">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">R</span>
    </a>
  
    
    <a href="/tags/#python">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Python</span>
    </a>
  
    
    <a href="/tags/#revoscaler">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">RevoScaleR</span>
    </a>
  
    
    <a href="/tags/#rxinstallpackages">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">rxInstallPackages</span>
    </a>
  
    
    <a href="/tags/#registerrext-exe">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">RegisterRext.exe</span>
    </a>
  
</div>
  </div>

  
  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "http://nielsberglund.com/2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/";
    this.page.identifier = "" ||
                           "http://nielsberglund.com/2018/06/30/installing-r-packages-in-sql-server-machine-learning-services-ii/";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//manageddata.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2018/08/12/interesting-stuff-week-32/">
            Interesting Stuff - Week 32
            <small>12 Aug 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/08/05/interesting-stuff-week-31/">
            Interesting Stuff - Week 31
            <small>05 Aug 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/08/04/sp-execute-external-script-and-sql-compute-context-iii/">
            sp_execute_external_script and SQL Compute Context - III
            <small>04 Aug 2018</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18914734-2', 'auto');
  ga('send', 'pageview');

</script>

    <!-- Optional footer content -->

  </body>
</html>
