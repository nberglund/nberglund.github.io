<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      sp_execute_external_script and Permissions &middot; Niels Berglund
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Niels Berglund
      </a>
    </div>
    <p class="lead">Technology musings about coding and data. Some topics: .NET, SQL Server, Data Science, R, Windows Azure and a lot more.</p>
  </header>
  <div>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Sidebar_rectangle -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-3005153158271538"
     data-ad-slot="7704601332"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
  </div>
  <br/>
  
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  

  
    
      <a class="page-link "
          href="/about/">About Me</a>
    
  

  
    
      <a class="page-link "
          href="/archive/">Posts Archive</a>
    
  

  
    
      <a class="page-link "
          href="/categories/">Categories</a>
    
  

  
    
  

  
    
      <a class="page-link "
          href="/disclaimer/">Disclaimer</a>
    
  

  
    
  

  
    
  

  

  
    
      <a class="page-link "
          href="/series/">Blog Post Series</a>
    
  

  
    
  

  
    
  

  
    
  

  
    
      <a class="page-link "
          href="/tags/">Tags</a>
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  


  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  
  <br/>
  <img src="/images/MVP_Logo_large.png"/>


  <section>
  <h3 style="color:#ffffff">Follow Me:</h3>
  <ul>
    <li><a href="https://twitter.com/nielsberglund" target="_blank">Twitter</a></li>
    <li><a href="http://feeds.feedburner.com/manageddata/" target="_blank">RSS/Atom Feed</a></li>
  </ul>
</section>
  
  <p>
  &copy; 2018.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">sp_execute_external_script and Permissions</h1>
  <div class="post-subheading">
  <span class="post-date">24 Jun 2018</span>

  <span class="post-tag">
    
      <br/>
      <span class="post-tagdesc">Categories:</span>
    

    
     <a href="/categories/#SQL Server">SQL Server</a>
    
     <a href="/categories/#Microsoft R Server">Microsoft R Server</a>
    
     <a href="/categories/#Microsoft Machine Learning Server">Microsoft Machine Learning Server</a>
    
     <a href="/categories/#Data Science">Data Science</a>
    
     <a href="/categories/#SQL Server R Services">SQL Server R Services</a>
    
     <a href="/categories/#SQL Server Machine Learning Services">SQL Server Machine Learning Services</a>
    

      
  </span>
</div>
  <br/>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3005153158271538"
     data-ad-slot="6668073777"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</header>
<div class="content">
  <div class="post-body">
    <p>This post will (hopefully) be short and sweet. It came about as I was testing out “stuff” for the <a href="/series/sql_server_ml_services_install_packages">Install R Packages in SQL Server ML Services</a> series of posts and I could not get it to work as I had expected.</p>

<!--more-->

<h2 id="background">Background</h2>

<p>Usually, when I work with <strong>SQL Server Machine Learning Services</strong>, I execute code in the context of admin (yeah I know, do not do that :)). In the <a href="/series/sql_server_ml_services_install_packages">Install R Packages in SQL Server ML Services</a> series I used non-admin accounts, and all of a sudden nothing worked.</p>

<p>I tried to research (read Google) the issue, but I could not find a definitive answer, just tidbits here and there. So when I finally realised what the issues were, I decided to write a blog post about it.</p>

<h2 id="housekeeping">Housekeeping</h2>

<p>As in quite a few of my other blog posts, here follows some code to set things up if you want to follow along.</p>

<h4 id="code">Code</h4>

<p>This is the code to “set the scene”:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">server_principals</span> 
              <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'user1'</span><span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="n">user1</span>
  <span class="k">WITH</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">'password1234$'</span><span class="p">;</span>
<span class="k">END</span>

<span class="k">DROP</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">PermissionDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">PermissionDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="n">USE</span> <span class="n">PermissionDB</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">user1</span>
<span class="k">FROM</span> <span class="n">LOGIN</span> <span class="n">user1</span><span class="p">;</span>
<span class="k">GO</span>
</code></pre></div></div>
<p><strong>Code Snippet 1:</strong> <em>Create Login, Database and User</em></p>

<p>In <em>Code Snippet 1</em> we create a login, a database, and then we create a user for the login in the database.</p>

<blockquote>
  <p><strong>NOTE:</strong> Below you see in quite a few places the abbreviation SPEES. That is short for <code class="highlighter-rouge">sp_excute_external_script</code>.</p>
</blockquote>

<h2 id="permissions">Permissions</h2>

<p>What we see in <em>Code Snippet 1</em> is that we have not assigned <code class="highlighter-rouge">user1</code> to any particular roles on either the server or the database, so <code class="highlighter-rouge">user1</code> has whatever default permissions he gets during creation. Let us look in <em>SSMS</em> UI and see what server level roles <code class="highlighter-rouge">user1</code> belongs to:</p>

<p><img src="/images/posts/sql_ml_speess_permissions1.png" alt="" /></p>

<p><strong>Figure 1:</strong> <em>Roles User1</em></p>

<p>In <em>Figure 1</em> we see how <code class="highlighter-rouge">user1</code> belongs to the server role <code class="highlighter-rouge">public</code>, and that is the only role he belongs to. So what if we have code like so:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">--uncomment the following and execute</span>
<span class="c1">--to execute as user1</span>
<span class="c1">--EXECUTE AS USER = 'user1';</span>
<span class="c1">--GO</span>

<span class="k">EXECUTE</span> <span class="n">sp_execute_external_script</span>
             <span class="o">@</span><span class="k">language</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'R'</span>
           <span class="p">,</span> <span class="o">@</span><span class="n">script</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'
               d&lt;-42
               OutputDataSet &lt;- as.data.frame(d)'</span>

<span class="c1">--to switch back from user1 uncomment and execute</span>
<span class="c1">--the following</span>
<span class="c1">--REVERT</span>
</code></pre></div></div>
<p><strong>Code Snippet 2:</strong> <em>Simple Test Code</em></p>

<p>The code in <em>Code Snippet 2</em> allows you to switch between admin/sa and <code class="highlighter-rouge">user1</code> without having to log in as <code class="highlighter-rouge">user1</code>.</p>

<p>If someone with sufficient permissions ran the code in <em>Code Snippet 2</em>, the result looks like so:</p>

<p><img src="/images/posts/sql_ml_spees_sa_exec.png" alt="" /></p>

<p><strong>Figure 2:</strong> <em>sa Executes SPEES</em></p>

<p>As we see in <em>Figure 2</em> we get back <a href="https://www.independent.co.uk/life-style/history/42-the-answer-to-life-the-universe-and-everything-2205734.html"><em>The Answer to the Ultimate Question of Life, the Universe and Everything.</em></a>, but if <code class="highlighter-rouge">user1</code> runs the same code, the result is:</p>

<p><img src="/images/posts/sql_ml_spees_sa_exec_error1.png" alt="" /></p>

<p><strong>Figure 3:</strong> <em>SPEES Execution Error</em></p>

<p>Oh, dear me, <code class="highlighter-rouge">user1</code> receives a permission denied exception! Well, from what we know about SQL Server and permissions it probably was not that unexpected. No problem, we know about SQL Server permissions, so we realise we probably have to <code class="highlighter-rouge">GRANT EXECUTE</code> permissions on <em>SPEES</em> to <code class="highlighter-rouge">user1</code> (or <code class="highlighter-rouge">public</code>):</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">sp_execute_external_script</span> <span class="k">to</span> <span class="n">user1</span><span class="p">;</span>
</code></pre></div></div>
<p><strong>Code Snippet 3:</strong> <em>Grant Execute Permission</em></p>

<p>Being in the database where <code class="highlighter-rouge">user1</code> exists and executing the code in <em>Code Snippet 3</em> as admin/sa - what could possibly go wrong:</p>

<p><img src="/images/posts/sql_ml_spees_perm_grant_error1.png" alt="" /></p>

<p><strong>Figure 4:</strong> <em>Grant Permission Error</em></p>

<p>Oops, something did go wrong, as it turns out that if you try to grant permissions on extended stored procedures, which <em>SPEES</em> is, you need to do it from the <code class="highlighter-rouge">master</code> database. Cool, let us switch to master and do it there. Well, if you try to do that - then you get another error: the user does not exist in <code class="highlighter-rouge">master</code>, sigh!</p>

<p>At this stage you have a couple of options:</p>

<ul>
  <li><del>Add the login for the user to the <code class="highlighter-rouge">sysadmin</code> role, or the user to the <code class="highlighter-rouge">db_owner</code> role in the actual database.</del> No do not do that, I am only kidding! Do.Not.Do.That!</li>
  <li>Create the user in <code class="highlighter-rouge">master</code> and grant the permission. That would work.</li>
  <li>Grant the permission to <code class="highlighter-rouge">public</code>.</li>
</ul>

<p>Both options above (I do not count <code class="highlighter-rouge">sysadmin</code>, <code class="highlighter-rouge">db_owner</code>) have drawbacks:</p>

<ul>
  <li>Create the user in <code class="highlighter-rouge">master</code>: you now have a user in master, and the question is what “shenanigans” the user can do.</li>
  <li>Grant permission to <code class="highlighter-rouge">public</code>: anyone can potentially execute <em>SPEES</em>, not ideal.</li>
</ul>

<p>For reasons that become clear later I go with granting permission to <code class="highlighter-rouge">public</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">master</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">sp_execute_external_script</span> <span class="k">to</span> <span class="k">public</span><span class="p">;</span>
</code></pre></div></div>
<p><strong>Code Snippet 4:</strong> <em>Granting Permission to Public</em></p>

<p>After admin/sa runs the code in <em>Code Snippet 4</em>, <code class="highlighter-rouge">user1</code> can now execute the code in <em>Code Snippet 2</em> and we should see <em>The Answer …</em>:</p>

<p><img src="/images/posts/sql_ml_spees_sa_exec_error2.png" alt="" /></p>

<p><strong>Figure 5:</strong> <em>SPEES Execution Error</em></p>

<p><a href="https://en.oxforddictionaries.com/definition/eish">Eish</a>, what goes on here? We did grant the permission in <em>Code Snippet 4</em>, so what now? Hmm, if we compare the errors, we see that they are slightly different. The error before granting the permission is something like: “The EXECUTE permission was denied …”, whereas the error after granting the permission is like: “The user does not have permission …”. It seems that the code in <em>Code Snippet 4</em> did something, but we still miss a piece (or multiple) of the puzzle, and it is permissions related. What permission(s) is the question?</p>

<p>So I decided to try a “brute force attack”; find all built in permissions in SQL Server, browse through them and see if I see something promising. For this, I used a SQL Server function: <code class="highlighter-rouge">sys.fn_builtin_permissions</code>, which - when executed - returns a description of the built-in permissions hierarchy of the server:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">fn_builtin_permissions</span><span class="p">(</span><span class="s1">'database'</span><span class="p">)</span>
</code></pre></div></div>
<p><strong>Code Snippet 5:</strong> <em>Retrieve All Functions</em></p>

<p>The parameter (<code class="highlighter-rouge">database</code>) in <em>Code Snippet 5</em> indicates what permissions I want back. In this case, I want all permissions on a database level. When I ran the code in <em>Code Snippet 5</em> the function call returned 78 rows, and towards the end of the result I saw something promising:</p>

<p><img src="/images/posts/sql_ml_spees_permissions.png" alt="" /></p>

<p><strong>Figure 6:</strong> <em>SPEES Execution Error</em></p>

<p>The highligthed part in <em>Figure 6</em> looks very interesting. I wonder what happens if I do something like this as admin/sa in the database the user is in:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ANY</span> <span class="k">EXTERNAL</span> <span class="n">SCRIPT</span> <span class="k">TO</span> <span class="n">user1</span>
</code></pre></div></div>
<p><strong>Code Snippet 5:</strong> <em>Grant External Script</em></p>

<p>The code in <em>Code Snippet 5</em> ran without any issues, and <code class="highlighter-rouge">user1</code> can then try following code:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">SUSER_NAME</span><span class="p">()</span>
<span class="k">EXECUTE</span> <span class="n">sp_execute_external_script</span>
             <span class="o">@</span><span class="k">language</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'R'</span>
           <span class="p">,</span> <span class="o">@</span><span class="n">script</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'
               d&lt;-42
               OutputDataSet &lt;- as.data.frame(d)'</span>
</code></pre></div></div>
<p><strong>Code Snippet 6:</strong> <em>Another Try by user1</em></p>

<p>The <code class="highlighter-rouge">SELECT SUSER_NAME()</code> in <em>Code Snippet 6</em> is there to verify that it is the correct user executing. The result when <code class="highlighter-rouge">user1</code> executes looks like so:</p>

<p><img src="/images/posts/sql_ml_spees_user1_exec.png" alt="" /></p>

<p><strong>Figure 6:</strong> <em>Successful Execution</em></p>

<p>So that was the missing link: <code class="highlighter-rouge">GRANT EXECUTE ANY EXTERNAL SCRIPT TO ...</code>, and to tell the truth; afterwards, I have seen a few posts on the net mentioning <code class="highlighter-rouge">EXECUTE ANY EXTERNAL SCRIPT</code>.</p>

<p>One more thing: above I mentioned that I favour granting the <code class="highlighter-rouge">EXECUTE</code> on <em>SPEES</em> to <code class="highlighter-rouge">public</code> instead of adding the user to <code class="highlighter-rouge">master</code>. The reason for this is what we just have seen: yes you do a “blanket” <code class="highlighter-rouge">GRANT</code> by granting <code class="highlighter-rouge">public</code>, but a user still needs to be granted <code class="highlighter-rouge">EXECUTE ANY EXTERNAL SCRIPT</code> before he can “go wild”. That gives admins/dba’s some control over who can execute <em>SPEES</em>.</p>

<h2 id="summary">Summary</h2>

<p>To allow a non-admin database user to execute <code class="highlighter-rouge">sp_execute_external_script</code> you need to:</p>

<ul>
  <li>Grant <code class="highlighter-rouge">public</code> execute permissions on <code class="highlighter-rouge">sp_execute_external_script</code>, and you do it in <code class="highlighter-rouge">master</code>. Obviously, you only need to do it once.</li>
  <li>Grant <code class="highlighter-rouge">EXECUTE ANY EXTERNAL SCRIPT</code> to the user in the different databases he needs to execute <em>SPEES</em> in.</li>
</ul>

<p>That is it!</p>

<p>One final thing: if you want to read more about <code class="highlighter-rouge">sp_execute_external_script</code>, <a href="/series/sql_server_2k16_r_services">SQL Server R Services</a> series has some posts.</p>

<h2 id="-finally">~ Finally</h2>

<p>If you have comments, questions etc., please comment on this post or <a href="mailto:niels.it.berglund@gmail.com">ping</a> me.</p>



    
<p>
<h2>Share this Post:</h2> 
<a href="https://twitter.com/intent/tweet?url=http://nielsberglund.com/2018/06/24/sp-execute-external-script-and-permissions/&text=sp_execute_external_script and Permissions&via=nielsberglund" 
   target="_blank">Twitter</a>
<a href="https://plus.google.com/share?url=http://www.nielsberglund.com//2018/06/24/sp-execute-external-script-and-permissions/" 
   onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
    | Google+</a>
<a href="https://www.linkedin.com/shareArticle?
         mini=true
         &url=http://www.nielsberglund.com/2018/06/24/sp-execute-external-script-and-permissions/
         &title=sp_execute_external_script and Permissions
         &summary=Blog post: We look at what permissions a non-admin user needs to execute sp_execute_external_script
         &source=http://www.nielsberglund.com/2018/06/24/sp-execute-external-script-and-permissions/"> | LinkedIn</a> 

</p>   
   <!--<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

   http://www.linkedin.com/shareArticle?mini=true&url=<URL>&title=<TITILE>&summary=<DESCRIPTION>&sourc


   https://www.linkedin.com/shareArticle?mini=true&url=http://nielsberglund.com/2018/06/24/sp-execute-external-script-and-permissions/

   -->



    <p>
<h2>Blog Feed:</h2>
To automatically receive more posts like this, please
<a href="http://feeds.feedburner.com/manageddata/" target="_blank"> subscribe to my RSS/Atom feed</a> in your feed reader!</p>


    <br/>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad2 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3005153158271538"
     data-ad-slot="1158080725"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    <br/>

    


  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
    <h2>Post Tags:</h2>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  


<div class="post-tags">
  
    
    <a href="/tags/#sql-server-r-services">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">SQL Server R Services</span>
    </a>
  
    
    <a href="/tags/#sql-server-machine-learning-services">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">SQL Server Machine Learning Services</span>
    </a>
  
    
    <a href="/tags/#r">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">R</span>
    </a>
  
    
    <a href="/tags/#python">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Python</span>
    </a>
  
    
    <a href="/tags/#sp-execute-external-script">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">sp_execute_external_script</span>
    </a>
  
    
    <a href="/tags/#sql-server-permissions">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">SQL Server Permissions</span>
    </a>
  
</div>
  </div>

  
  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "http://nielsberglund.com/2018/06/24/sp-execute-external-script-and-permissions/";
    this.page.identifier = "" ||
                           "http://nielsberglund.com/2018/06/24/sp-execute-external-script-and-permissions/";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//manageddata.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2018/08/12/interesting-stuff-week-32/">
            Interesting Stuff - Week 32
            <small>12 Aug 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/08/05/interesting-stuff-week-31/">
            Interesting Stuff - Week 31
            <small>05 Aug 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/08/04/sp-execute-external-script-and-sql-compute-context-iii/">
            sp_execute_external_script and SQL Compute Context - III
            <small>04 Aug 2018</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18914734-2', 'auto');
  ga('send', 'pageview');

</script>

    <!-- Optional footer content -->

  </body>
</html>
