<!DOCTYPE html> <html lang="en-us"> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <meta name="description" content="We look at how to use sqlrutils to create SQL Server stored procedures from inside an R environment."> <meta name="keywords" content="SQL Server, Data Science, SQL Server R Services, R, sqlrutils, sp_execute_external_script"/> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> Creating R Stored Procedures in SQL Server 2016 Using sqlrutils &middot; Niels Berglund </title> <!-- CSS --> <link rel="stylesheet" href="/public/css/poole.css"> <link rel="stylesheet" href="/public/css/syntax.css"> <link rel="stylesheet" href="/public/css/hyde.css"> <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"> <!-- Icons --> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png"> <link rel="shortcut icon" href="/public/favicon.ico"> <!-- RSS --> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <link href='/stylesheets/all-6937d9aff18f4bd864a4e4772a407120.css' media='all' rel='stylesheet' type='text/css'> <!-- Begin Jekyll SEO tag v2.3.0 --> <title>Creating R Stored Procedures in SQL Server 2016 Using sqlrutils | Niels Berglund</title> <meta property="og:title" content="Creating R Stored Procedures in SQL Server 2016 Using sqlrutils" /> <meta name="author" content="nielsb" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="We look at how to use sqlrutils to create SQL Server stored procedures from inside an R environment." /> <meta property="og:description" content="We look at how to use sqlrutils to create SQL Server stored procedures from inside an R environment." /> <link rel="canonical" href="http://nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/" /> <meta property="og:url" content="http://nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/" /> <meta property="og:site_name" content="Niels Berglund" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-06-25T17:19:20+02:00" /> <script type="application/ld+json"> {"name":null,"description":"We look at how to use sqlrutils to create SQL Server stored procedures from inside an R environment.","author":{"@type":"Person","name":"nielsb"},"@type":"BlogPosting","url":"http://nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/","publisher":null,"image":null,"headline":"Creating R Stored Procedures in SQL Server 2016 Using sqlrutils","dateModified":"2017-06-25T17:19:20+02:00","datePublished":"2017-06-25T17:19:20+02:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"http://nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/"},"@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script> (adsbygoogle = window.adsbygoogle || []).push({ google_ad_client: "ca-pub-3005153158271538", enable_page_level_ads: true }); </script> </head> <body> <div class="sidebar"> <div class="container"> <div class="sidebar-about"> <h1> <a href="/"> Niels Berglund </a> </h1> <p class="lead">Technology musings about coding and data. Some topics: .NET, SQL Server, Data Science, R, Windows Azure and a lot more.</p> </div> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- Sidebar_rectangle --> <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-3005153158271538" data-ad-slot="7704601332"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Home</a> <a class="sidebar-nav-item" href="/about/">About</a> <a class="sidebar-nav-item" href="/archive/">Posts Archive</a> <a class="sidebar-nav-item" href="/categories/">Categories</a> <a class="sidebar-nav-item" href="/disclaimer/">Disclaimer</a> <a class="sidebar-nav-item" href="/tags/">Tags</a> </nav> <img class="center" src="/images/MVP_Logo_large.png" width="300" height="121" > <section> <h3 style="color:#ffffff">Follow Me:</h3> <ul> <li><a href="https://twitter.com/nielsberglund" target="_blank">Twitter</a></li> <li><a href="http://feeds.feedburner.com/manageddata/" target="_blank">RSS/Atom Feed</a></li> </ul> </section> <p>&copy; 2018. All rights reserved.</p> <div class="sidebar-social"> <div><a href="https://github.com/nberglund"> GitHub </a></div> <div><a href="https://twitter.com/nielsberglund"> Twitter </a></div> <div><a href="https://za.linkedin.com/in/niels-berglund-0122593"> LinkedIn </a></div> <div><a href="https://plus.google.com/u/0/109374849138720664008"> Google+ </a></div> </div> </div> </div> <div class="content container"> <div class="post"> <h1 class="post-title">Creating R Stored Procedures in SQL Server 2016 Using sqlrutils</h1> <div class="post-subheading"> <span class="post-date">25 Jun 2017</span> <span class="post-tag"> <span class="post-tagdesc">in categories:</span> <a href="/categories/#SQL Server">SQL Server</a> <a href="/categories/#Data Science">Data Science</a> <a href="/categories/#SQL Server R Services">SQL Server R Services</a> <a href="/categories/#R">R</a> <span class="post-tagdesc">tags:</span> <a href="/tags/#SQL Server">SQL Server</a> <a href="/tags/#Data Science">Data Science</a> <a href="/tags/#SQL Server R Services">SQL Server R Services</a> <a href="/tags/#R">R</a> <a href="/tags/#sqlrutils">sqlrutils</a> <a href="/tags/#sp_execute_external_script">sp_execute_external_script</a> </span> </div> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- Ad1 --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3005153158271538" data-ad-slot="6668073777" data-ad-format="auto"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <br/> <p>In the <a href="https://social.msdn.microsoft.com/Forums/en-US/home?forum=MicrosoftR">Microsoft R Server forum</a> the other day was a <a href="https://social.msdn.microsoft.com/Forums/en-US/5759339f-ec8a-4c70-b05c-081d56542c84/sql-server-r-services-stored-procedures-inputs">question</a> about inputs to SQL Server R stored procedures, or rather about "strange" parameter naming, when using the <strong>sqlrutils</strong> package. I got intrigued by the question and started <del>playing around with</del> researching it, and this blog-post is the result. Oh, and this blog-post would never have seen the light of the day, if it hadn't been for the original poster of the question: <a href="https://social.msdn.microsoft.com/profile/jd%20long/">JD Long</a>, thanks JD!</p> <p>So, what is SQL Server R stored procedures and what is <strong>sqlrutils</strong>?</p> <!--more--> <p>Before we answer the question above, let's do a quick recap of <code>sp_execute_external_script</code>.</p> <h2><code>sp_execute_external_script</code></h2> <p>The procedure <code>sp_execute_external_script</code> is an extended stored procedure, and it allows us to execute R scripts (and in SQL 2017 also Python) from inside SQL Server. You use it by passing it the script you want to execute as well as various parameters. Let's assume you have some R code looking like so:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Iris Dataset</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># set a variable</span><span class="w"></span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">multiplier</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5</span><span class="w">
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1">#get the iris data set as a data frame</span><span class="w"></span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">iris_dataset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="w">
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># grab the setosa species</span><span class="w"></span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">setosa</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="p">,]</span><span class="w">
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># calculate mean of the Sepal.Width for setosa</span><span class="w"></span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">menSepWidth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">setosa</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span><span class="w">
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># use the multiplier to do some "stuff</span><span class="w"></span>
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">iris_dataset</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris_dataset</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multiplier</span><span class="w">
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># look at the resulting dataset </span><span class="w"></span>
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">View</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span><span class="w">
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># print out the mean</span><span class="w"></span>
</div></div><div data-line='20' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">print</span><span class="p">(</span><span class="n">menSepWidth</span><span class="p">)</span><span class="w"></span></div></div></pre></div></figure></p> <p><strong>Code Snippet 1:</strong> <em>R Script</em></p> <p>As you see in <em>Code Snippet 1</em>, we:</p> <ul> <li>Set the value of the <code>multiplier</code> variable.</li> <li>Reads in the <code>iris</code> data into a data frame: <code>iris_dataset</code>.</li> <li>Create a new data frame for the <code>setosa</code> species.</li> <li>Calculate the <code>mean</code> of the <code>Sepal.Width</code> for <code>setosa</code> and assigns that to a variable: <code>menSepWidth</code>.</li> <li>Multiply the <code>Sepal.Length</code> property with the <code>multiplier</code> variable.</li> <li>Finally output the calculated property, and print out the <code>menSepWidth</code> variable.</li> </ul> <p>Yes, yes, I know - the code is very, very simplistic, but it will still get the points across.</p> <blockquote><p><strong>NOTE:</strong> If you haven't heard about the <code>iris</code> dataset before, you can read more about it <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">here</a>.</p></blockquote> <p>To use this script in SQL Server with <code>sp_execute_external_script</code>, you would write something like this:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>R Script in SQL</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">DECLARE</span> <span class="o">@</span><span class="n">out_val</span> <span class="n">float</span><span class="p">;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">exec</span> <span class="n">sp_execute_external_script</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="k">language</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'R'</span><span class="p">,</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">script</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>        iris_dataset &lt;- iris
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>        setosa &lt;- iris[iris$Species == "setosa",]
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>        menSepWidth &lt;- mean(setosa$Sepal.Width)
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>        iris_dataset$Sepal.Length &lt;- iris_dataset$Sepal.Length * multiplier
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>        OutputDataSet &lt;- data.frame(iris_dataset$Sepal.Length)    <br/>
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>      '</span><span class="p">,</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">params</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'@multiplier float, @menSepWidth float OUTPUT'</span><span class="p">,</span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">multiplier</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">menSepWidth</span> <span class="o">=</span> <span class="o">@</span><span class="n">out_val</span> <span class="k">OUTPUT</span>
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="k">WITH</span> <span class="k">RESULT</span> <span class="k">SETS</span> <span class="p">((</span><span class="n">SepalLength</span> <span class="n">float</span><span class="p">));</span><br/>
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='20' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">SELECT</span> <span class="o">@</span><span class="n">out_val</span> <span class="k">AS</span> <span class="n">MeanSepWidth</span></div></div></pre></div></figure></p> <p><strong>Code Snippet 2:</strong> <em>The iris Script in SQL Server</em></p> <p>As you see from <em>Code Snippet 2</em>, the R script is passed in to the <code>@script</code> parameter of <code>sp_execute_external_script</code>. The actual script looks almost identical to what is in <em>Code Snippet 1</em>, except for instead of the <code>View(iris_dataset$Sepal.Length)</code>, we use <code>OutputDataSet</code>. The <code>OutputDataSet</code> variable is a well known variable in SQL Server R Services, and it is the default variable that will contain the data to be returned to SQL Server as a result-set upon completion of the stored procedure call. The layout of the result-set is defined in the <code>WITH RESULT SETS</code> statement, and in <em>Code Snippet 2</em> above we are interested in one column, of type <code>float</code> and we name it <code>SepalLength</code>.</p> <p>The parameters we use are defined in the <code>@params</code> parameter, followed by the parameters themselves. In this case <code>@multiplier</code> which we set to 5, and <code>@menSepWidth</code> which is <code>OUTPUT</code>. If you have used <code>sp_executesql</code> the parameter syntax should be familiar to you. We assign the (at the top of the script) declared <code>@out_val</code> variable to the <code>@menSepWidth</code> output parameter, and at the end of the script we <code>SELECT</code> it out.</p> <p>When running <em>Code Snippet 2</em>, the output will be like in the two figures below:</p> <p><img class="center" src="/images/posts/sqlrutils_extscript_result.png" width="153" height="139" > <strong>Figure 1:</strong> <em>Result-set</em></p> <p><em>Figure 1</em> shows the output from <code>OutputDataSet</code>, the calculated <code>Sepal.Length</code> column.</p> <p><img class="center" src="/images/posts/sqlrutils_extscript_outparam.png" width="139" height="48" > <strong>Figure 2:</strong> <em>Output Parameter</em></p> <p>In <em>Figure 2</em> we see the output parameter; <code>@menSepWidth</code>.</p> <p>This is nice, being able to execute <code>sp_execute_external_script</code>, and run our R scripts in SQL Server. However how do I operationalize this, I can't really be running these scripts every time I want to "crunch" some data?! Well, the answer to that is to wrap the code we see in <em>Code Snippet 2</em> in a stored procedure, which would take the necessary parameters, and then execute <code>sp_execute_external_script</code> inside the procedure.</p> <p>To make it easier to create wrapping procedures, Microsoft has an R package to help with this: <strong>sqlrutils</strong>.</p> <h2>sqlrutils</h2> <p>The sqlrutils package allows R users to, from inside an R IDE of choice, put their R scripts into a T-SQL stored procedure, register that stored procedure with a database, and run the stored procedure from an R development environment.</p> <p>Let us see what the package does. To do that run from inside an R IDE, I am using R Tools for Visual Studio 2017 (RTVS), <code>help(package="sqlrutils")</code>.</p> <blockquote><p><strong>NOTE:</strong> Before you run the <code>help</code> statement above, you may have to run: <code>library(sqlrutils)</code>, to load the package.</p></blockquote> <p>When running `help(package="sqlrutils"), the httpd help server starts and you should see something like so:</p> <p><img class="center" src="/images/posts/sqlrutils_help.png" width="550" height="528" > <strong>Figure 3:</strong> <em>Output from Help</em></p> <p>In <em>Figure 3</em> you see the various function the package exposes. Now, let's see what we can do with it.</p> <h3>R Function</h3> <p>It is considered best practices to rewrite your R script as a function, and pass necessary parameters to the function. So we take our script and turn it into a function:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Function</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">irisFunc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span><span class="w"> </span><span class="p">&#x7b;</span><span class="w">
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="n">iris_dataset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="w">
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="n">setosa</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="p">,]</span><span class="w">
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="n">menSepWidth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">setosa</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span><span class="w">
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="n">iris_dataset</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris_dataset</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multiplier</span><span class="w">
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="n">sepLength</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span><span class="w">
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="n">retList</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">sepLengthData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sepLength</span><span class="p">,</span><span class="w">
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>                  </span><span class="n">menSepWidthValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">menSepWidth</span><span class="p">)</span><span class="w">
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>  </span><span class="nf">return</span><span class="p">(</span><span class="n">retList</span><span class="p">)</span><span class="w"></span>
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;</span><span class="w"></span></div></div></pre></div></figure></p> <p><strong>Code Snippet 3:</strong> <em>Create Function</em></p> <p>In <em>Code Snippet 3</em> we create the function and we:</p> <ul> <li>pass in the <code>multiplier</code> parameter</li> <li>declare the <code>menSepWidth</code> variable inside the function</li> <li>assign <code>iris_dataset$Sepal.Length</code> to a data frame variable</li> <li>create a named list, containing the data frame as well as <code>menSepWidth</code> variable</li> <li>return the list</li> </ul> <p>The function will eventually be part of the script inside <code>sp_execute_external_script</code>, but before we go there we should define the required parameters for the procedure.</p> <h3>Define Parameters</h3> <p>In this example we have three parameters / objects:</p> <ul> <li>the <code>multiplier</code> input parameter</li> <li>the <code>menSepWidth</code> output parameter</li> <li>the output dataset</li> </ul> <p>When looking at the output from the <code>help</code> as in <em>Figure 3</em>, we see some functions that looks like doing what we want to do:</p> <ul> <li><code>InputParameter</code></li> <li><code>OutputData</code></li> <li><code>OutputParameter</code></li> </ul> <p>So to create our parameters we write some code like in <em>Code Snippet 4</em>:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Parameters</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># if the sqlrutils package is not loaded yet:</span><span class="w"></span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="c1"># library("sqlrutils")</span><span class="w">
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">inParam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">InputParameter</span><span class="p">(</span><span class="s2">"multiplier"</span><span class="p">,</span><span class="w"> </span><span class="s2">"numeric"</span><span class="p">)</span><span class="w"></span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">outParam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">OutputParameter</span><span class="p">(</span><span class="s2">"menSepWidthValue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"numeric"</span><span class="p">)</span><span class="w"></span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">outputData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">OutputData</span><span class="p">(</span><span class="s2">"sepLengthData"</span><span class="p">)</span><span class="w"></span></div></div></pre></div></figure></p> <p><strong>Code Snippet 4:</strong> <em>Parameter Creation</em></p> <p>Notice how the output dataset, and the output parameter are named as the names in the list. This is important as we will see in a little bit. You can have multiple parameters (input/output), but only one output data set. If you have multiple parameters you define them as in <em>Code Snippet 4</em>.</p> <p>Now when the parameters are defined, we can create the stored procedure.</p> <h3>Procedure Creation</h3> <p>To create a stored procedure we use the <code>StoredProcedure</code> class generator, and the signature of <code>StoredProcedure</code> looks like so:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Signature</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">StoredProcedure</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w">
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>               </span><span class="n">spName</span><span class="p">,</span><span class="w">
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>               </span><span class="n">...</span><span class="p">,</span><span class="w">
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>               </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w">
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>               </span><span class="n">dbName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w">
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>               </span><span class="n">connectionString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w">
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>               </span><span class="n">batchSeparator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"GO"</span><span class="p">)</span><span class="w"></span></div></div></pre></div></figure></p> <p><strong>Code Snippet 5:</strong> <em>Signature for StoredProcedure Class Generator</em></p> <p>The arguments in the signature are:</p> <ul> <li><code>func</code> - the function name, of the function we want wrapped.</li> <li><code>spName</code> - name for the generated stored procedure</li> <li><code>...</code> - optional input and output parameters (including output dataset)</li> <li><code>filePath</code> - optional path to where to create and save a .sql source file.</li> <li><code>dbName</code> - optional name specifying the database to use in the script file.</li> <li><code>connectionString</code> - optional connection string.</li> <li><code>batchSeparator</code> - what batch separator to use.</li> </ul> <p>So, let's see what we should do to create a stored procedure based on what we have done so far (the code snippet below includes the parameter definitions from *Code Snippet 4):</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Stored Procedure</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">inParam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">InputParameter</span><span class="p">(</span><span class="s2">"multiplier"</span><span class="p">,</span><span class="w"> </span><span class="s2">"numeric"</span><span class="p">)</span><span class="w"></span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">outParam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">OutputParameter</span><span class="p">(</span><span class="s2">"menSepWidthValue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"numeric"</span><span class="p">)</span><span class="w"></span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">outputData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">OutputData</span><span class="p">(</span><span class="s2">"sepLengthData"</span><span class="p">)</span><span class="w">
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">irisProc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">StoredProcedure</span><span class="p">(</span><span class="n">irisFunc</span><span class="p">,</span><span class="w">
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>                      </span><span class="s2">"pr_IrisProc"</span><span class="p">,</span><span class="w">
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>                      </span><span class="n">inParam</span><span class="p">,</span><span class="w">
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>                      </span><span class="n">outputData</span><span class="p">,</span><span class="w">
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>                      </span><span class="n">outParam</span><span class="p">,</span><span class="w">
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>                      </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Temp"</span><span class="w">
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>                      </span><span class="p">)</span><span class="w"></span></div></div></pre></div></figure></p> <p><strong>Code Snippet 6:</strong> <em>Generate Stored Procedure from R Function</em></p> <p>In <em>Code Snippet 6</em> we:</p> <ul> <li>define the function to use is the function assigned to the <code>irisFunc</code> variable from <em>Code Snippet 3</em>.</li> <li>say that we want the created procedure to be named <code>pr_IrisProc</code>.</li> <li>define the input and output parameters though the variables we have created. If you have defined more parameters (as we spoke about above), you add them to the <code>StoredProcedure</code> call.</li> <li>set the file path where we want the source files to be created.</li> </ul> <p>We skip the rest of the arguments, and when we run the code in <em>Code Snippet 6</em>, the source file looks like so:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Generated Procedure</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">IF</span> <span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">(</span><span class="s1">'pr_IrisProc'</span><span class="p">)</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="n">pr_IrisProc</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">GO</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">pr_IrisProc</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="o">@</span><span class="n">parallel_outer</span> <span class="n">bit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="o">@</span><span class="n">multiplier_outer</span> <span class="n">float</span><span class="p">,</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="o">@</span><span class="n">menSepWidthValue_outer</span> <span class="n">float</span> <span class="k">output</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">AS</span>
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="k">BEGIN</span> <span class="n">TRY</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="k">exec</span> <span class="n">sp_execute_external_script</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="k">language</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'R'</span><span class="p">,</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">script</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>        irisFunc &lt;- function (multiplier)
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>        &#x7b;
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>            iris_dataset &lt;- iris
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>            setosa &lt;- iris[iris$Species == "setosa", ]
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>            menSepWidth &lt;- mean(setosa$Sepal.Width)
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>            iris_dataset$Sepal.Length &lt;- iris_dataset$Sepal.Length *
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'>                multiplier
</div></div><div data-line='20' class='code-highlight-row numbered'><div class='code-highlight-line'>            sepLength &lt;- data.frame(iris_dataset$Sepal.Length)
</div></div><div data-line='21' class='code-highlight-row numbered'><div class='code-highlight-line'>            retList &lt;- list(sepLengthData = sepLength, menSepWidthValue = menSepWidth)
</div></div><div data-line='22' class='code-highlight-row numbered'><div class='code-highlight-line'>            return(retList)
</div></div><div data-line='23' class='code-highlight-row numbered'><div class='code-highlight-line'>        &#x7d;
</div></div><div data-line='24' class='code-highlight-row numbered'><div class='code-highlight-line'>        result &lt;- irisFunc(multiplier = multiplier)
</div></div><div data-line='25' class='code-highlight-row numbered'><div class='code-highlight-line'>        if (is.list(result)) &#x7b;
</div></div><div data-line='26' class='code-highlight-row numbered'><div class='code-highlight-line'>          OutputDataSet &lt;- result$sepLengthData
</div></div><div data-line='27' class='code-highlight-row numbered'><div class='code-highlight-line'>          menSepWidthValue &lt;- result$menSepWidthValue
</div></div><div data-line='28' class='code-highlight-row numbered'><div class='code-highlight-line'>        &#x7d; else stop("the R function must return a list")
</div></div><div data-line='29' class='code-highlight-row numbered'><div class='code-highlight-line'>      '</span><span class="p">,</span>
</div></div><div data-line='30' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">parallel</span> <span class="o">=</span> <span class="o">@</span><span class="n">parallel_outer</span><span class="p">,</span>
</div></div><div data-line='31' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">params</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'@multiplier float, @menSepWidthValue float output'</span><span class="p">,</span>
</div></div><div data-line='32' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">multiplier</span> <span class="o">=</span> <span class="o">@</span><span class="n">multiplier_outer</span><span class="p">,</span>
</div></div><div data-line='33' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="o">@</span><span class="n">menSepWidthValue</span> <span class="o">=</span> <span class="o">@</span><span class="n">menSepWidthValue_outer</span> <span class="k">output</span>
</div></div><div data-line='34' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="k">END</span> <span class="n">TRY</span>
</div></div><div data-line='35' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="k">BEGIN</span> <span class="n">CATCH</span>
</div></div><div data-line='36' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="n">THROW</span><span class="p">;</span>
</div></div><div data-line='37' class='code-highlight-row numbered'><div class='code-highlight-line'>  <span class="k">END</span> <span class="n">CATCH</span><span class="p">;</span>
</div></div><div data-line='38' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">GO</span></div></div></pre></div></figure></p> <p><strong>Code Snippet 7:</strong> <em>Generated Stored Procedure</em></p> <p>That looks OK, a couple of things to point out:</p> <ul> <li>Parameter names are appended with <em>_outer</em>. This is what <a href="https://social.msdn.microsoft.com/profile/jd%20long/">JD Long</a> asked about; where comes that from? It seems to be the convention to do that, to separate the parameters for <code>sp_execute_external_script</code> from the parameters for the <em>outer</em> procedure. Hence the <em>_outer</em> in the name.</li> <li>What's this <code>@parallel_outer</code> parameter, we did not define it anywhere? In <code>sp_execute_external_script</code> you have the ability to define that you wish the execution of the R script should happen in parallel, and <code>@parallel</code> is an existing parameter on <code>sp_execute_external_script</code>. So by default, this parameter is always created (and defaulted to 0).</li> <li>We then see the function definition as part of the <code>@script</code> parameter, together with generated code to execute and retrieve the results. This is where it is important that you return a named list from the function, especially if you have more than one output parameter (including the output dataset). The names in the list should be the same as you set in your parameter definitions.</li> </ul> <p>You can now take the source file and deploy the procedure to a database of your choice. Then you execute the procedure as so:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Execute Proc</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">DECLARE</span> <span class="o">@</span><span class="k">out</span> <span class="n">float</span><span class="p">;</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">EXEC</span> <span class="n">pr_IrisProc</span> <span class="o">@</span><span class="n">parallel_outer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>                  <span class="o">@</span><span class="n">multiplier_outer</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>                  <span class="o">@</span><span class="n">menSepWidthValue_outer</span> <span class="o">=</span> <span class="o">@</span><span class="k">out</span> <span class="k">OUT</span><span class="p">;</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">SELECT</span> <span class="o">@</span><span class="k">out</span><span class="p">;</span></div></div></pre></div></figure></p> <p><strong>Code Snippet 8:</strong> <em>Execution of Generated Procedure</em></p> <p>When executing, you should get the same result as you see in <em>Figure 1</em> and <em>Figure 2</em>.</p> <h3>Deploying from R</h3> <p>Above we deployed the created procedure by running the script from SQL Server Management Studio, on the database we wanted to deploy to. You can also deploy straight from R, by using <code>registerStoredProcedure</code>. The signature of <code>registerStoredProcedure</code> looks like in <em>Code Snippet 8</em>:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Signature</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">registerStoredProcedure</span><span class="p">(</span><span class="n">sqlSP</span><span class="p">,</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>                        <span class="n">connectionString</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">)</span></div></div></pre></div></figure></p> <p><strong>Code Snippet 8:</strong> <em>Signature of registerStoredProcedure</em></p> <p>We see in <em>Code Snippet 8</em> how <code>registerStoredProcedure</code> takes the generated stored procedure object (created by <code>StoredProcedure</code>), and an optional connection string. It is optional as the connection string can be defined in <code>StoredProcedure</code>.</p> <p>If we want to deploy to SQL Server directly the code looks like so:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>tile: "Deploy"</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">conStr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s2">"Driver=&#x7b;ODBC Driver 13 for SQL Server&#x7d;;Server=.;"</span><span class="p">,</span><span class="w">
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>                 </span><span class="s2">"Database=RTest;uid=sa;pwd=secretpassword;"</span><span class="p">)</span><span class="w">
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'></span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">registerStoredProcedure</span><span class="p">(</span><span class="n">irisProc</span><span class="p">,</span><span class="w"> </span><span class="n">conStr</span><span class="p">)</span><span class="w"></span></div></div></pre></div></figure></p> <p><strong>Code Snippet 9:</strong> <em>Deploying from R</em></p> <p>In <em>Code Snippet 9</em>, we continue from <em>Code Snippet 6</em>, and we have created the stored procedure object <code>irisProc</code>. We create a connection string, and pass <code>irisProc</code> and the connection string to <code>registerStoredProcedure</code>. After executing the code in <em>Code Snippet 9</em>, you should see the procedure in the database.</p> <p>As you know, by using <code>sp_execute_external_script</code>, we can now in SQL Server 2016 and 2017 execute R scripts (and in SQL 2017 also Python) from inside SQL Server. <code>sp_execute_external_script</code> is a SQL Server extended stored procedure and you pass in the script to execute as well as parameter info to the procedure.</p> <h2>~ Finally</h2> <p>If you have comments, questions etc., please comment on this post or <a href="mailto:niels.it.berglund@gmail.com">ping</a> me.</p> <p> <h2>Share this Post:</h2> <a href="https://twitter.com/intent/tweet?url=http://nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/&text=Creating R Stored Procedures in SQL Server 2016 Using sqlrutils&via=nielsberglund" target="_blank">Twitter</a> <a href="https://plus.google.com/share?url=http://www.nielsberglund.com//2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"> | Google+</a> <a href="https://www.linkedin.com/shareArticle? mini=true &url=http://www.nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/ &title=Creating R Stored Procedures in SQL Server 2016 Using sqlrutils &summary=Blog post: We look at how to use sqlrutils to create SQL Server stored procedures from inside an R environment. &source=http://www.nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/"> | LinkedIn</a> </p> <!--<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script> http://www.linkedin.com/shareArticle?mini=true&url=<URL>&title=<TITILE>&summary=<DESCRIPTION>&sourc https://www.linkedin.com/shareArticle?mini=true&url=http://nielsberglund.com/2017/06/25/creating-r-stored-procedures-in-sql-server-2016-using-sqlrutils/ --> <p> <h2>Blog Feed:</h2> To automatically receive more posts like this, please <a href="http://feeds.feedburner.com/manageddata/" target="_blank"> subscribe to my RSS/Atom feed</a> in your feed reader!</p> <br/> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- Ad2 --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3005153158271538" data-ad-slot="1158080725" data-ad-format="auto"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <br/> </div> <div class="related"> <h2>Related Posts</h2> <div class="related-posts"> <h3><a href="/2018/03/11/microsoft-sql-server-r-services-sp-execute-external-script-ii/"> Microsoft SQL Server R Services - sp_execute_external_script - II <small> (11 Mar 2018)</small> </a></h3> </div> <div class="related-posts"> <h3><a href="/2018/03/07/microsoft-sql-server-r-services-sp_execute_external_script-I/"> Microsoft SQL Server R Services - sp_execute_external_script - I <small> (07 Mar 2018)</small> </a></h3> </div> <div class="related-posts"> <h3><a href="/2018/03/04/interesting-stuff-week-9/"> Interesting Stuff - Week 9 <small> (04 Mar 2018)</small> </a></h3> </div> </div> <div id="disqus_thread"></div> <script> var disqus_developer = 1; (function() { /*DON'T EDIT BELOW THIS LINE*/ var d = document, s = d.createElement('script'); s.src = '//manageddata.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-18914734-2', 'auto'); ga('send', 'pageview'); </script> </body> </html>
