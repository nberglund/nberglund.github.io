<!DOCTYPE html> <html lang="en-us"> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <meta name="description" content="Python in SQL Server 2017. Here we have a brief look at the Python support in SQL Server 2017."> <meta name="keywords" content="SQL Server R Services, R, RevoScaleR, Python, Julia"/> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> SQL Server 2017 - Python Executing Inside SQL Server &middot; Niels Berglund </title> <!-- CSS --> <link rel="stylesheet" href="/public/css/poole.css"> <link rel="stylesheet" href="/public/css/syntax.css"> <link rel="stylesheet" href="/public/css/hyde.css"> <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"> <!-- Icons --> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png"> <link rel="shortcut icon" href="/public/favicon.ico"> <!-- RSS --> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <link href='/stylesheets/all-6937d9aff18f4bd864a4e4772a407120.css' media='all' rel='stylesheet' type='text/css'> <!-- Begin Jekyll SEO tag v2.3.0 --> <title>SQL Server 2017 - Python Executing Inside SQL Server | Niels Berglund</title> <meta property="og:title" content="SQL Server 2017 - Python Executing Inside SQL Server" /> <meta name="author" content="nielsb" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Python in SQL Server 2017. Here we have a brief look at the Python support in SQL Server 2017." /> <meta property="og:description" content="Python in SQL Server 2017. Here we have a brief look at the Python support in SQL Server 2017." /> <link rel="canonical" href="http://localhost:4000/2017/04/20/sql-server-2017-python-executing-from-sql/" /> <meta property="og:url" content="http://localhost:4000/2017/04/20/sql-server-2017-python-executing-from-sql/" /> <meta property="og:site_name" content="Niels Berglund" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-04-20T20:49:08+02:00" /> <script type="application/ld+json"> {"name":null,"description":"Python in SQL Server 2017. Here we have a brief look at the Python support in SQL Server 2017.","author":{"@type":"Person","name":"nielsb"},"@type":"BlogPosting","url":"http://localhost:4000/2017/04/20/sql-server-2017-python-executing-from-sql/","publisher":null,"image":null,"headline":"SQL Server 2017 - Python Executing Inside SQL Server","dateModified":"2017-04-20T20:49:08+02:00","datePublished":"2017-04-20T20:49:08+02:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2017/04/20/sql-server-2017-python-executing-from-sql/"},"@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="sidebar"> <div class="container"> <div class="sidebar-about"> <h1> <a href="/"> Niels Berglund </a> </h1> <p class="lead">Technology musings about coding and data. Some topics: .NET, SQL Server, Data Science, R, Windows Azure and a lot more.</p> </div> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Home</a> <a class="sidebar-nav-item" href="/about/">About</a> <a class="sidebar-nav-item" href="/archive/">Posts Archive</a> <a class="sidebar-nav-item" href="/categories/">Categories</a> <a class="sidebar-nav-item" href="/disclaimer/">Disclaimer</a> <a class="sidebar-nav-item" href="/tags/">Tags</a> </nav> <img class="center" src="/images/MVP_Logo.png" width="181" height="74" > <section> <h3 style="color:#ffffff">Follow Me:</h3> <ul> <li><a href="https://twitter.com/nielsberglund" target="_blank">Twitter</a></li> <li><a href="http://feeds.feedburner.com/manageddata/" target="_blank">RSS/Atom Feed</a></li> </ul> </section> <p>&copy; 2017. All rights reserved.</p> <div class="sidebar-social"> <div><a href="https://github.com/nberglund"> GitHub </a></div> <div><a href="https://twitter.com/nielsberglund"> Twitter </a></div> <div><a href="https://za.linkedin.com/in/niels-berglund-0122593"> LinkedIn </a></div> <div><a href="https://plus.google.com/u/0/109374849138720664008"> Google+ </a></div> </div> </div> </div> <div class="content container"> <div class="post"> <h1 class="post-title">SQL Server 2017 - Python Executing Inside SQL Server</h1> <div class="post-subheading"> <span class="post-date">20 Apr 2017</span> <span class="post-tag"> <span class="post-tagdesc">in categories:</span> <a href="/categories/#SQL Server">SQL Server</a> <a href="/categories/#Data Science">Data Science</a> <span class="post-tagdesc">tags:</span> <a href="/tags/#SQL Server R Services">SQL Server R Services</a> <a href="/tags/#R">R</a> <a href="/tags/#RevoScaleR">RevoScaleR</a> <a href="/tags/#Python">Python</a> <a href="/tags/#Julia">Julia</a> </span> </div> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- Ad1 --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3005153158271538" data-ad-slot="6668073777" data-ad-format="auto"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <br/> <p>On April 19, 2017 Microsoft held an on-line conference <strong>Microsoft Data Amp</strong> to showcase how Microsoft’s latest innovations put data, analytics and artificial intelligence at the heart of business transformation. The keynotes speakers were <a href="https://en.wikipedia.org/wiki/Scott_Guthrie">Scott "Red Shirt" Guthrie</a> who is an <em>Microsoft Executive Vice President</em> (fairly high on the food-chain), and <a href="https://social.technet.microsoft.com/Profile/Joseph%20Sirosh">Joseph Sirosh</a> a <em>Corporate Vice President</em>, head of the Information Management and Machine Learning group. Joseph probably knows a thing or two about data, and Scott - well, Scott knows <strong>A LOT</strong>!</p> <p>During the keynotes, Scott and Joseph shared how Microsoft’s latest innovations put data, analytics and artificial intelligence at the heart of business transformation. A big enabler for this is <strong>SQL Server 2017</strong> (the "artist" formerly known as SQL Server V.Next), which introduces a lot of very cool new "stuff".</p> <p>The keynote speeches were followed by recorded short:ish sessions drilling down into certain aspects of Microsoft's new offerings. If you are interested in the various presentations at <strong>Microsoft Data Amp</strong>, they all are on <a href="https://channel9.msdn.com/Events/Data-Science/Microsoft-Data-Amp-2017">Channel 9</a>.</p> <p>What caught my eye was the announcement of how <strong>SQL Server 2017</strong> now supports Python as an extensible script engine. When Microsoft introduced support for R in SQL Server 2016, rumors immediately surfaced how other engines also would be supported, where Python was high on the list (<a href="https://julialang.org/">Julia</a> another one).</p> <p>Seeing that I am somewhat into <strong>SQL Server R Services</strong> (the SQL Server 2016 flavor) <a href="/2017/03/04/microsoft-sql-server-2016-r-services-installation/">here</a>, <a href="/2017/03/18/microsoft-sql-server-r-services-internals-i/">here</a>, <a href="/2017/04/02/microsoft-sql-server-r-services-internals-ii/">here</a>, <a href="/2017/04/13/microsoft-sql-server-r-services-internals-iii/">here</a>, and more posts to come, I really had to have a look.</p> <p>The rest of this post is a brief introduction to executing Python code in <strong>SQL Server 2017</strong>, in essence I just want to be able to execute some sort of Python code.</p> <!--more--> <h2>Installation</h2> <p>The installation steps of external scripts engines doe not differ much (at all) from the installation in SQL Server 2016, apart from the fact you now can install Python. So if you feel you need more information abut the install process, please go and read my <a href="/2017/03/04/microsoft-sql-server-2016-r-services-installation/"><strong>Microsoft SQL Server 2016 R Services Installation</strong></a> post.</p> <p>I downloaded the <strong>SQL Server 2017</strong> CTP 2.0, and after battling trying to register (I assume a couple of other people had the same idea as myself), I managed to get an <code>iso</code> down to my machine and installed it as an instance. During <em>Feature Selection</em> at installation time we can see that the promise of Python was not a lie. It is part of <em>Machine Learning Services</em>, as in <em>Figure 1</em>:</p> <p><img class="center" src="/images/posts/sql2k17_python_install.png" width="289" height="145" > <strong>Figure 1:</strong> <em>Python Option In Database</em></p> <p>Looking further we also see how Python can be installed as a stand-alone engine:</p> <p><img class="center" src="/images/posts/sql2k17_python_standalone.png" width="260" height="74" > <strong>Figure 2:</strong> <em>Python Option In Database</em></p> <p>The stand-alone installation option is useful, for example,if a data scientist want to run Python (or R) on his or her own machine.</p> <blockquote><p><strong>NOTE:</strong> You may wonder why, in <em>Figure 2</em>, the check boxes for R as well as Python is checked, but "dimmed" out? This is because, on this particular machine, I have already installed the standalone versions once.</p></blockquote> <p>OK, so after successful installation, and if you have installed the SQL Server engine, R services and Python services you should see something like so in the <code>C:\path_to_instance</code> folder:</p> <p><img class="center" src="/images/posts/sql2k17_python_directories.png" width="428" height="135" > <strong>Figure 3:</strong> <em>Finished Install</em></p> <p>Now, let's test this "shiny new thing out". Oh, in this post I leave out all "grunge" about the launchpad service, etc. If you are interested go ahead and read about it in the <a href="/2017/03/04/microsoft-sql-server-2016-r-services-installation/">previously mentioned post</a>.</p> <h2>Execute Python Code in SQL Server 2017</h2> <p>After we have done the installation, but before we can execute the Python (or R) code we need to enable the execution of external scripts. As I covered in the post <a href="/2017/03/04/microsoft-sql-server-2016-r-services-installation/"><strong>Microsoft SQL Server 2016 R Services Installation</strong></a> you enable external scripts by changing the configuration as in <em>Code Snippet 2</em> <strong>AND</strong> restarting the instance.</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Enable External Scripts</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">EXEC</span> <span class="n">sp_configure</span>  <span class="s1">'external scripts enabled'</span><span class="p">,</span> <span class="mi">1</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="n">RECONFIGURE</span>  <span class="k">WITH</span> <span class="n">OVERRIDE</span>  </div></div></pre></div></figure></p> <p><strong>Code Snippet 2:</strong> <em>Execute sp_configure</em></p> <p>After having enabled everything let's execute <code>sp_execute_external_script</code>. The code is very, very basic - more or less the least what we can get by with for Python. It does have some similarities with the code in the <a href="/2017/03/04/microsoft-sql-server-2016-r-services-installation/"><strong>Microsoft SQL Server 2016 R Services Installation</strong></a> post, and <em>Code Snippet 2</em> shows the code:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Execution of Python Script</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">EXEC</span> <span class="n">sp_execute_external_script</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="o">@</span><span class="k">language</span> <span class="o">=</span><span class="n">N</span><span class="s1">'Python'</span><span class="p">,</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="o">@</span><span class="n">script</span><span class="o">=</span> <span class="n">N</span><span class="s1">'print("The Answer Is 42!!!")'</span><span class="p">;</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">GO</span> </div></div></pre></div></figure></p> <p><strong>Code Snippet 3:</strong> <em>Test That Python Installation Works</em></p> <p>In <em>Code Snippet 3</em>, we say that the language is Python (the <code>@language</code> parameter), and that the script we want to execute is a Python print statement: <code>print("The Answer Is 42!!!")</code>. That's all!</p> <p>When executing this, something like so should be printed out in the <em>Messages</em> tab in <strong>SQL Server Management Studio</strong>:</p> <p><img class="center" src="/images/posts/sql2k17_python_execution_result.png" width="515" height="100" > <strong>Figure 4:</strong> <em>Result from Python Execution</em></p> <p>We have now executed our first Python code in <strong>SQL Server 2017</strong>. Just for "giggles", let us ensure that we still can execute R code:</p> <p><figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>Execution of R Script</span></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">EXEC</span> <span class="n">sp_execute_external_script</span>  <span class="o">@</span><span class="k">language</span> <span class="o">=</span><span class="n">N</span><span class="s1">'R'</span><span class="p">,</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>                                 <span class="o">@</span><span class="n">script</span><span class="o">=</span><span class="n">N</span><span class="s1">'OutputDataSet&lt;-InputDataSet'</span><span class="p">,</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'>                                 <span class="o">@</span><span class="n">input_data_1</span> <span class="o">=</span><span class="n">N</span><span class="s1">'SELECT 42'</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>      <span class="k">WITH</span> <span class="k">RESULT</span> <span class="k">SETS</span> <span class="p">(([</span><span class="n">TheAnswer</span><span class="p">]</span> <span class="n">int</span> <span class="k">not</span> <span class="k">null</span><span class="p">));</span><br/>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">GO</span> </div></div></pre></div></figure></p> <p><strong>Code Snippet 4:</strong> <em>Test That Execution of R Still Works</em></p> <p>That <em>should</em> work, and you will see something like so:</p> <p><img class="center" src="/images/posts/r_result_set.png" width="160" height="80" > <strong>Figure 5:</strong> <em>Result of Execution of R Script</em></p> <p>That seemed to work OK, let's ship it!</p> <h2>Summary</h2> <p>We have in this post seen how <strong>SQL Server 2017</strong> introduces support for execution if Python in addition to R scripts. There is obviously a lot more to the above than what I have covered in the above, and I will definitely come back to both Python as well as R in future posts.</p> <p>If you have comments, questions etc., please comment on this post or <a href="mailto:niels.it.berglund@gmail.com">ping</a> me.</p> <p> <h2>Share this Post:</h2> <a href="https://twitter.com/intent/tweet?url=http://localhost:4000/2017/04/20/sql-server-2017-python-executing-from-sql/&text=SQL Server 2017 - Python Executing Inside SQL Server&via=nielsberglund" target="_blank">Twitter</a> <a href="https://plus.google.com/share?url=http://www.nielsberglund.com//2017/04/20/sql-server-2017-python-executing-from-sql/" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"> | Google+</a> <a href="https://www.linkedin.com/shareArticle? mini=true &url=http://www.nielsberglund.com/2017/04/20/sql-server-2017-python-executing-from-sql/ &title=SQL Server 2017 - Python Executing Inside SQL Server &summary=Blog post: Python in SQL Server 2017. Here we have a brief look at the Python support in SQL Server 2017. &source=http://www.nielsberglund.com/2017/04/20/sql-server-2017-python-executing-from-sql/"> | LinkedIn</a> </p> <!--<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script> http://www.linkedin.com/shareArticle?mini=true&url=<URL>&title=<TITILE>&summary=<DESCRIPTION>&sourc https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2017/04/20/sql-server-2017-python-executing-from-sql/ --> <p> <h2>Blog Feed:</h2> To automatically receive more posts like this, please <a href="http://feeds.feedburner.com/manageddata/" target="_blank"> subscribe to my RSS/Atom feed</a> in your feed reader!</p> <br/> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- Ad2 --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3005153158271538" data-ad-slot="1158080725" data-ad-format="auto"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <br/> </div> <div class="related"> <h2>Related Posts</h2> <div class="related-posts"> <h3><a href="/2017/10/31/microsoft-sql-server-r-services-internals-xii/"> Microsoft SQL Server R Services - Internals XII <small> (31 Oct 2017)</small> </a></h3> </div> <div class="related-posts"> <h3><a href="/2017/10/20/microsoft-sql-server-r-services-internals-xi/"> Microsoft SQL Server R Services - Internals XI <small> (20 Oct 2017)</small> </a></h3> </div> <div class="related-posts"> <h3><a href="/2017/08/29/microsoft-sql-server-r-services-internals-x/"> Microsoft SQL Server R Services - Internals X <small> (29 Aug 2017)</small> </a></h3> </div> </div> <div id="disqus_thread"></div> <script> var disqus_developer = 1; (function() { /*DON'T EDIT BELOW THIS LINE*/ var d = document, s = d.createElement('script'); s.src = '//manageddata.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-18914734-2', 'auto'); ga('send', 'pageview'); </script> </body> </html>
